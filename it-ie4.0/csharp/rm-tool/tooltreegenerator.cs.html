<!DOCTYPE html> <html><head>
		<title>ToolTreeGenerator.cs</title>
		<base href="..\..\..\../">
		<meta id="root-path" root-path="..\..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Mindmap Obsidian - ToolTreeGenerator.cs">
		<meta property="og:title" content="ToolTreeGenerator.cs">
		<meta property="og:description" content="Mindmap Obsidian - ToolTreeGenerator.cs">
		<meta property="og:type" content="website">
		<meta property="og:url" content="volvo/it-ie4.0/csharp/rm-tool/tooltreegenerator.cs.html">
		<meta property="og:image" content="undefined">
		<meta property="og:site_name" content="Mindmap Obsidian">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/supported-plugins.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="ToolTreeGenerator.cs">ToolTreeGenerator.cs</h1><div class="el-p"><p dir="auto">This code is responsible for generating a hierarchical structure of zones, sub-zones, and assets based on data from two tables (<code>toolTreeTable</code> and <code>mdlTable</code>). It processes each row of the tables to extract relevant information, and builds the hierarchy by creating <code>Zones</code>, <code>SubZone1</code>, <code>MainAsset</code>, and <code>SubAsset</code> objects accordingly. The code includes mechanisms to handle missing or mismatched data, adding appropriate logging and setting conditions, such as disabling checkboxes for incomplete information. The ultimate goal is to provide a structured representation of the tools and assets, including parts and asset numbers, while handling inconsistencies effectively.</p></div><div class="el-pre"><pre class="language-csharp" tabindex="0"><code data-line="0" class="language-csharp is-loaded"><span class="token keyword">using</span> <span class="token namespace">RMTOOL</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>ObjectModel</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Diagnostics</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Media</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ToolTreeGenerator</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Private members to hold references to the input data tables.</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">DataTable</span> toolTreeTable<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">DataTable</span> mdlTable<span class="token punctuation">;</span>

    <span class="token comment">// Constructor to initialize the ToolTreeGenerator with tool tree and mdl tables.</span>
    <span class="token keyword">public</span> <span class="token function">ToolTreeGenerator</span><span class="token punctuation">(</span><span class="token class-name">DataTable</span> toolTreeTable<span class="token punctuation">,</span> <span class="token class-name">DataTable</span> mdlTable<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>toolTreeTable <span class="token operator">=</span> toolTreeTable<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>mdlTable <span class="token operator">=</span> mdlTable<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Method to generate a collection of Zones from the tool tree data.</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">ObservableCollection<span class="token punctuation">&lt;</span>Zones<span class="token punctuation">&gt;</span></span> <span class="token function">GenerateZones</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Lists to store values from the tool tree table.</span>
        <span class="token class-name"><span class="token keyword">var</span></span> plcValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">var</span></span> machineNumbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">var</span></span> descriptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">var</span></span> mainAssetNumbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Iterate through each row in the tool tree table to extract necessary values.</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">DataRow</span> row <span class="token keyword">in</span> toolTreeTable<span class="token punctuation">.</span>Rows<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// Extract and trim values from the data row.</span>
            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">?</span></span> plcValue <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">"PLC"</span><span class="token punctuation">]</span><span class="token punctuation">?.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">?.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">?</span></span> machineNumber <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">"Machinenumber"</span><span class="token punctuation">]</span><span class="token punctuation">?.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">?.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">?</span></span> description <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">"Description"</span><span class="token punctuation">]</span><span class="token punctuation">?.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">?.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">?</span></span> mainAssetNumber <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">"Asset Number"</span><span class="token punctuation">]</span><span class="token punctuation">?.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">?.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// If any value is missing, log a warning and skip the row.</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>plcValue<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>machineNumber<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>description<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>mainAssetNumber<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Warning: Missing important data (PLC, Machine, Description, or Main Asset Number). Skipping this row."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Add the valid values to their respective lists.</span>
            plcValues<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>plcValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
            machineNumbers<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>machineNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
            descriptions<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>description<span class="token punctuation">)</span><span class="token punctuation">;</span>
            mainAssetNumbers<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>mainAssetNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Build the hierarchy of zones using the collected values.</span>
        <span class="token keyword">return</span> <span class="token function">BuildZonesHierarchy</span><span class="token punctuation">(</span>plcValues<span class="token punctuation">,</span> machineNumbers<span class="token punctuation">,</span> descriptions<span class="token punctuation">,</span> mainAssetNumbers<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Method to build a hierarchy of Zones, SubZones, and MainAssets.</span>
    <span class="token keyword">private</span> <span class="token return-type class-name">ObservableCollection<span class="token punctuation">&lt;</span>Zones<span class="token punctuation">&gt;</span></span> <span class="token function">BuildZonesHierarchy</span><span class="token punctuation">(</span><span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> plcValues<span class="token punctuation">,</span> <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> machineNumbers<span class="token punctuation">,</span> <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> descriptions<span class="token punctuation">,</span> <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> mainAssetNumbers<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> zonesCollection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ObservableCollection<span class="token punctuation">&lt;</span>Zones<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">var</span></span> zonesDict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> Zones<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Iterate through the extracted data to build the zone hierarchy.</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> plcValues<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> plcValue <span class="token operator">=</span> plcValues<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> machineNumber <span class="token operator">=</span> machineNumbers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> description <span class="token operator">=</span> descriptions<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> mainAssetNumber <span class="token operator">=</span> mainAssetNumbers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token comment">// Check if the zone already exists, if not create a new one.</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>zonesDict<span class="token punctuation">.</span><span class="token function">ContainsKey</span><span class="token punctuation">(</span>plcValue<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token class-name"><span class="token keyword">var</span></span> newZone <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Zones</span>
                <span class="token punctuation">{</span>
                    Zone <span class="token operator">=</span> plcValue<span class="token punctuation">,</span>
                    SubZone1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ObservableCollection<span class="token punctuation">&lt;</span>SubZone1<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
                zonesDict<span class="token punctuation">[</span>plcValue<span class="token punctuation">]</span> <span class="token operator">=</span> newZone<span class="token punctuation">;</span>
                zonesCollection<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>newZone<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token class-name"><span class="token keyword">var</span></span> currentZone <span class="token operator">=</span> zonesDict<span class="token punctuation">[</span>plcValue<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">// Check if the SubZone1 already exists, if not create a new one.</span>
            <span class="token class-name"><span class="token keyword">var</span></span> existingSubZone1 <span class="token operator">=</span> currentZone<span class="token punctuation">.</span>SubZone1<span class="token punctuation">?.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span>subZone1 <span class="token operator">=&gt;</span> subZone1<span class="token punctuation">.</span>Name <span class="token operator">==</span> machineNumber <span class="token operator">&amp;&amp;</span> subZone1<span class="token punctuation">.</span>Description <span class="token operator">==</span> description<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>existingSubZone1 <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                existingSubZone1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SubZone1</span>
                <span class="token punctuation">{</span>
                    Name <span class="token operator">=</span> machineNumber<span class="token punctuation">,</span>
                    Description <span class="token operator">=</span> description<span class="token punctuation">,</span>
                    MainAssets <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ObservableCollection<span class="token punctuation">&lt;</span>MainAsset<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
                currentZone<span class="token punctuation">.</span>SubZone1<span class="token punctuation">?.</span><span class="token function">Add</span><span class="token punctuation">(</span>existingSubZone1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Check if the MainAsset already exists, if not create a new one.</span>
            <span class="token class-name"><span class="token keyword">var</span></span> existingMainAsset <span class="token operator">=</span> existingSubZone1<span class="token punctuation">.</span>MainAssets<span class="token punctuation">?.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span>mainAsset <span class="token operator">=&gt;</span> mainAsset<span class="token punctuation">.</span>MainAssetNumber <span class="token operator">==</span> mainAssetNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>existingMainAsset <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                existingMainAsset <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MainAsset</span>
                <span class="token punctuation">{</span>
                    MainAssetNumber <span class="token operator">=</span> mainAssetNumber<span class="token punctuation">,</span>
                    SubAssets <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ObservableCollection<span class="token punctuation">&lt;</span>SubAsset<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
                existingSubZone1<span class="token punctuation">.</span>MainAssets<span class="token punctuation">?.</span><span class="token function">Add</span><span class="token punctuation">(</span>existingMainAsset<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Add sub-assets to the main asset.</span>
            <span class="token function">AddSubAssets</span><span class="token punctuation">(</span>existingMainAsset<span class="token punctuation">,</span> mainAssetNumber<span class="token punctuation">,</span> machineNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> zonesCollection<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Method to add sub-assets to a main asset.</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">AddSubAssets</span><span class="token punctuation">(</span><span class="token class-name">MainAsset</span> mainAsset<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> mainAssetNumber<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> machineNumber<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Entering AddSubAssets method."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name"><span class="token keyword">bool</span></span> matchFound <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        <span class="token comment">// Create a list to store all subAssetPartNumber values for logging.</span>
        <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> subAssetPartNumbersLogged <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Dictionary to track SubAssets by mdlAssetNumber for progressive evaluation.</span>
        <span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> SubAsset<span class="token punctuation">&gt;</span></span> subAssetMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> SubAsset<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Iterate through each row in the mdl table to find matching sub-assets.</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">DataRow</span> mdlRow <span class="token keyword">in</span> mdlTable<span class="token punctuation">.</span>Rows<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Inside foreach loop, iterating over mdlTable rows."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Extract and trim values from the mdl data row.</span>
            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">?</span></span> mdlAssetNumber <span class="token operator">=</span> mdlRow<span class="token punctuation">[</span><span class="token string">"Asset No."</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">?.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">?</span></span> equipmentLocationNumber <span class="token operator">=</span> mdlRow<span class="token punctuation">[</span><span class="token string">"EQUIPMENT LOCATION NUMBER \n(M)"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">?.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">?</span></span> partNumber <span class="token operator">=</span> mdlRow<span class="token punctuation">[</span><span class="token string">"MAXIMO\nITEM NO."</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">?.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">?</span></span> manufactValue <span class="token operator">=</span> mdlRow<span class="token punctuation">[</span><span class="token string">"MANUFACTURE ART. NO.\n(M)"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">?.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">?</span></span> typeValue <span class="token operator">=</span> mdlRow<span class="token punctuation">[</span><span class="token string">"TYPE DESIGNATION\n(M)"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">?.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">?</span></span> indexValue <span class="token operator">=</span> mdlRow<span class="token punctuation">[</span><span class="token string">"No."</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">?.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Log data to ensure we understand the state.</span>
            Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Processing mdlAssetNumber: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">mdlAssetNumber</span><span class="token punctuation">}</span></span><span class="token string">, equipmentLocationNumber: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">equipmentLocationNumber</span><span class="token punctuation">}</span></span><span class="token string">, partNumber: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">partNumber</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Skip rows with an empty asset number.</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>mdlAssetNumber<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Warning: mdlAssetNumber is empty. Skipping this row."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Check if the mdlAssetNumber matches the mainAssetNumber.</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>mdlAssetNumber<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> mdlAssetNumber<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>mainAssetNumber<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token comment">// Check if the equipment location number matches the machine number.</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>equipmentLocationNumber<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> equipmentLocationNumber <span class="token operator">==</span> machineNumber<span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    matchFound <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                    Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Found matching machine number: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">machineNumber</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Check if the SubAsset already exists or create a new one.</span>
                    <span class="token class-name">SubAsset</span> existingSubAsset<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>subAssetMap<span class="token punctuation">.</span><span class="token function">ContainsKey</span><span class="token punctuation">(</span>mdlAssetNumber<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{</span>
                        existingSubAsset <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SubAsset</span>
                        <span class="token punctuation">{</span>
                            AssetNumber <span class="token operator">=</span> mdlAssetNumber<span class="token punctuation">,</span>
                            PartNumbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ObservableCollection<span class="token punctuation">&lt;</span>PartNumberInfo<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            IsCheckBoxEnabled <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token comment">// Start with true and change later if needed based on part numbers.</span>
                        <span class="token punctuation">}</span><span class="token punctuation">;</span>
                        subAssetMap<span class="token punctuation">[</span>mdlAssetNumber<span class="token punctuation">]</span> <span class="token operator">=</span> existingSubAsset<span class="token punctuation">;</span>
                        mainAsset<span class="token punctuation">.</span>SubAssets<span class="token punctuation">?.</span><span class="token function">Add</span><span class="token punctuation">(</span>existingSubAsset<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Created new SubAsset for mdlAssetNumber: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">mdlAssetNumber</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{</span>
                        existingSubAsset <span class="token operator">=</span> subAssetMap<span class="token punctuation">[</span>mdlAssetNumber<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">// Track if all parts are effective.</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>partNumber<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{</span>
                        <span class="token class-name"><span class="token keyword">string</span></span> combinedPartNumber <span class="token operator">=</span> partNumber<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">"Not Found"</span><span class="token punctuation">)</span>
                            <span class="token punctuation">?</span> <span class="token interpolation-string"><span class="token string">$"Rownumber : </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">indexValue</span><span class="token punctuation">}</span></span><span class="token string"> --&gt; </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">partNumber</span><span class="token punctuation">}</span></span><span class="token string"> - Manufacture Art No: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">manufactValue</span><span class="token punctuation">}</span></span><span class="token string"> - Type Designation: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">typeValue</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
                            <span class="token punctuation">:</span> partNumber<span class="token punctuation">;</span>

                        <span class="token comment">// Set the color of the part number.</span>
                        <span class="token class-name">Brush</span> color <span class="token operator">=</span> combinedPartNumber<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">"Not Found"</span><span class="token punctuation">)</span> <span class="token punctuation">?</span> Brushes<span class="token punctuation">.</span>Purple <span class="token punctuation">:</span> Brushes<span class="token punctuation">.</span>Black<span class="token punctuation">;</span>

                        <span class="token comment">// Add part number info to the SubAsset.</span>
                        existingSubAsset<span class="token punctuation">.</span>PartNumbers<span class="token punctuation">?.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">PartNumberInfo</span>
                        <span class="token punctuation">{</span>
                            PartNumber <span class="token operator">=</span> combinedPartNumber<span class="token punctuation">,</span>
                            PartColor <span class="token operator">=</span> color
                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                        <span class="token comment">// Disable checkbox if there is an error in the part number.</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>combinedPartNumber<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">"Not Found"</span><span class="token punctuation">)</span> <span class="token operator">||</span> combinedPartNumber<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">"Mismatch"</span><span class="token punctuation">)</span> <span class="token operator">||</span> combinedPartNumber<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">"Missing"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{</span>
                            existingSubAsset<span class="token punctuation">.</span>IsCheckBoxEnabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>

                        Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Part number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">combinedPartNumber</span><span class="token punctuation">}</span></span><span class="token string"> added to Asset No.: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">mdlAssetNumber</span><span class="token punctuation">}</span></span><span class="token string"> with color </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">color</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{</span>
                    <span class="token comment">// Handle cases where there's no location number or the location doesn't match.</span>
                    <span class="token class-name"><span class="token keyword">string</span></span> subAssetPartNumber<span class="token punctuation">;</span>
                    <span class="token class-name">Brush</span> partColor<span class="token punctuation">;</span>

                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>equipmentLocationNumber<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{</span>
                        subAssetPartNumber <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"Rownumber : </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">indexValue</span><span class="token punctuation">}</span></span><span class="token string"> --&gt; Equipment Location Number Missing in MDL"</span></span><span class="token punctuation">;</span>
                        partColor <span class="token operator">=</span> Brushes<span class="token punctuation">.</span>Blue<span class="token punctuation">;</span>
                        matchFound <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// Differentiate from complete mismatch.</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{</span>
                        subAssetPartNumber <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"Rownumber : </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">indexValue</span><span class="token punctuation">}</span></span><span class="token string"> --&gt; Equipment location number(MDL) mismatch with Tooltree"</span></span><span class="token punctuation">;</span>
                        partColor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SolidColorBrush</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Color<span class="token punctuation">)</span>ColorConverter<span class="token punctuation">.</span><span class="token function">ConvertFromString</span><span class="token punctuation">(</span><span class="token string">"#9E3A00"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">// Add subAssetPartNumber to the log list.</span>
                    subAssetPartNumbersLogged<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>subAssetPartNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Adding subAssetPartNumber to list: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">subAssetPartNumber</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Check if the SubAsset already exists or create a new one.</span>
                    <span class="token class-name">SubAsset</span> existingSubAsset<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>subAssetMap<span class="token punctuation">.</span><span class="token function">ContainsKey</span><span class="token punctuation">(</span>mdlAssetNumber<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{</span>
                        existingSubAsset <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SubAsset</span>
                        <span class="token punctuation">{</span>
                            AssetNumber <span class="token operator">=</span> mdlAssetNumber<span class="token punctuation">,</span>
                            PartNumbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ObservableCollection<span class="token punctuation">&lt;</span>PartNumberInfo<span class="token punctuation">&gt;</span></span>
                        <span class="token punctuation">{</span>
                            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PartNumberInfo</span>
                            <span class="token punctuation">{</span>
                                PartNumber <span class="token operator">=</span> subAssetPartNumber<span class="token punctuation">,</span>
                                PartColor <span class="token operator">=</span> partColor
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            IsCheckBoxEnabled <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token comment">// Default to false if there's an error message.</span>
                        <span class="token punctuation">}</span><span class="token punctuation">;</span>
                        subAssetMap<span class="token punctuation">[</span>mdlAssetNumber<span class="token punctuation">]</span> <span class="token operator">=</span> existingSubAsset<span class="token punctuation">;</span>
                        mainAsset<span class="token punctuation">.</span>SubAssets<span class="token punctuation">?.</span><span class="token function">Add</span><span class="token punctuation">(</span>existingSubAsset<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">subAssetPartNumber</span><span class="token punctuation">}</span></span><span class="token string"> for Asset No.: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">mdlAssetNumber</span><span class="token punctuation">}</span></span><span class="token string">, adding to tree view."</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{</span>
                        existingSubAsset <span class="token operator">=</span> subAssetMap<span class="token punctuation">[</span>mdlAssetNumber<span class="token punctuation">]</span><span class="token punctuation">;</span>
                        existingSubAsset<span class="token punctuation">.</span>PartNumbers<span class="token punctuation">?.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">PartNumberInfo</span>
                        <span class="token punctuation">{</span>
                            PartNumber <span class="token operator">=</span> subAssetPartNumber<span class="token punctuation">,</span>
                            PartColor <span class="token operator">=</span> partColor
                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">subAssetPartNumber</span><span class="token punctuation">}</span></span><span class="token string"> for Asset No.: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">mdlAssetNumber</span><span class="token punctuation">}</span></span><span class="token string">, adding part number to existing sub-asset."</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">// Always set IsCheckBoxEnabled to false if there's any error-related subAssetPartNumber.</span>
                    existingSubAsset<span class="token punctuation">.</span>IsCheckBoxEnabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Log all the subAssetPartNumbers after processing.</span>
        Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Logging all subAssetPartNumbers:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> subAssetPart <span class="token keyword">in</span> subAssetPartNumbersLogged<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>subAssetPart<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="mod-footer mod-ui"></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\tooltreegenerator.cs.html#ToolTreeGenerator.cs"><div class="tree-item-contents heading-link" heading-name="ToolTreeGenerator.cs"><span class="tree-item-title">ToolTreeGenerator.cs</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>