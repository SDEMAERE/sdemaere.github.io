<!DOCTYPE html> <html><head>
		<title>Mainwindow.xaml.cs</title>
		<base href="..\..\..\../">
		<meta id="root-path" root-path="..\..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Mindmap Obsidian - Mainwindow.xaml.cs">
		<meta property="og:title" content="Mainwindow.xaml.cs">
		<meta property="og:description" content="Mindmap Obsidian - Mainwindow.xaml.cs">
		<meta property="og:type" content="website">
		<meta property="og:url" content="volvo/it-ie4.0/csharp/rm-tool/mainwindow.xaml.cs.html">
		<meta property="og:image" content="undefined">
		<meta property="og:site_name" content="Mindmap Obsidian">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/supported-plugins.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="ONLOADED">ONLOADED</h1><div class="el-h1 heading-wrapper"><div class="heading-children"><div class="el-p"><p dir="auto">The <a href="?query=tag:OnLoaded" class="tag" target="_blank" rel="noopener nofollow">#OnLoaded</a> method is an asynchronous event handler triggered when a UI element is loaded. It performs the following key tasks:</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><strong>Initialize Database Connector</strong>: Sets up a <a data-href="DatabaseConnector.cs" href="volvo/it-ie4.0/csharp/rm-tool/databaseconnector.cs.html" class="internal-link" target="_self" rel="noopener nofollow">DatabaseConnector.cs</a> with progress bars for visual feedback.</li>
<li data-line="2" dir="auto"><strong>Define and Execute Query</strong>: Defines a SQL query to fetch data from a database, filtering inventory items by status and location.</li>
<li data-line="4" dir="auto"><strong>Fetch Data Asynchronously</strong>: Uses the database connector to asynchronously fetch the query results. It updates the first checkbox (<code>Check1</code>) based on whether any data is returned and hides a progress bar (<code>Pbar3</code>) if no results are found.</li>
<li data-line="6" dir="auto"><strong>Process Data Rows</strong>: Iterates through each row of the fetched data, skipping rows where key fields (<code>CXMANUFACTURERNUM</code> and <code>CXMANTYPED</code>) are empty. It cleans and formats these fields, creates <a data-href="MaximoData.cs" href="volvo/it-ie4.0/csharp/rm-tool/maximodata.cs.html" class="internal-link" target="_self" rel="noopener nofollow">MaximoData.cs</a> objects, and adds them to a list (<code>MaximoList</code>).</li>
<li data-line="8" dir="auto"><strong>Update UI Elements</strong>: Updates the data grid (<code>MaximoGrid</code>) to display the fetched results, enables the browse button (<code>BTN_Browse</code>), and sets the second checkbox (<code>Check2</code>) to checked.</li>
<li data-line="10" dir="auto"><strong>Exception Handling</strong>: Catches and displays any exceptions that occur during the data fetching and processing, ensuring the application handles errors gracefully.</li>
</ol></div><div class="el-pre"><pre class="language-csharp" tabindex="0"><code data-line="0" class="language-csharp is-loaded"><span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnLoaded</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">RoutedEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">try</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Initialize the database connector with progress bars</span>
        <span class="token class-name">DatabaseConnector</span> dbConnector <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DatabaseConnector</span><span class="token punctuation">(</span>Pbar2<span class="token punctuation">,</span> Pbar3<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Set the first checkbox to checked state</span>
        Check1<span class="token punctuation">.</span>IsChecked <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

        <span class="token comment">// Define the SQL query to fetch data from the database</span>
        <span class="token class-name"><span class="token keyword">var</span></span> query <span class="token operator">=</span> <span class="token string">@"
                        SELECT 
                            ITEM.ITEMNUM, 
                            ITEM.DESCRIPTION, 
                            INVENTORY.STATUS, 
                            INVENTORY.LOCATION, 
                            ITEM.CXMANUFACTURERNUM, 
                            ITEM.CXMANTYPED
                        FROM 
                            MAXIMO.ITEM 
                        INNER JOIN 
                            MAXIMO.INVENTORY ON ITEM.ITEMNUM = INVENTORY.ITEMNUM
                        WHERE 
                            INVENTORY.STATUS IN ('ACTIVE', 'PLANNING') 
                            AND INVENTORY.LOCATION LIKE 'MAGVCG%'
                    "</span><span class="token punctuation">;</span>

        <span class="token comment">// Fetch data from the database asynchronously using ODBC</span>
        resultsODBC <span class="token operator">=</span> <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> dbConnector<span class="token punctuation">.</span><span class="token function">FetchDataODBCAsync</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Set Check1 based on whether any rows were returned</span>
        Check1<span class="token punctuation">.</span>IsChecked <span class="token operator">=</span> resultsODBC<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token comment">// If no data is returned, hide the third progress bar</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>resultsODBC<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Pbar3<span class="token punctuation">.</span>Visibility <span class="token operator">=</span> Visibility<span class="token punctuation">.</span>Collapsed<span class="token punctuation">;</span>
            Pbar3<span class="token punctuation">.</span>IsIndeterminate <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Process each row in the result set</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">DataRow</span> row <span class="token keyword">in</span> resultsODBC<span class="token punctuation">.</span>Rows<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// Skip rows where both CXMANUFACTURERNUM and CXMANTYPED are empty</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>row<span class="token punctuation">.</span><span class="token function">IsNull</span><span class="token punctuation">(</span><span class="token string">"CXMANUFACTURERNUM"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> row<span class="token punctuation">.</span><span class="token function">IsNull</span><span class="token punctuation">(</span><span class="token string">"CXMANTYPED"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// Skip this row</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Clean and convert CXMANUFACTURERNUM and CXMANTYPED fields to lowercase</span>
            <span class="token class-name"><span class="token keyword">var</span></span> cxManufacturerNum <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">IsNull</span><span class="token punctuation">(</span><span class="token string">"CXMANUFACTURERNUM"</span><span class="token punctuation">)</span> <span class="token punctuation">?</span> <span class="token keyword">null</span> <span class="token punctuation">:</span> Regex<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">"CXMANUFACTURERNUM"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token class-name"><span class="token keyword">string</span> <span class="token punctuation">?</span></span><span class="token punctuation">?</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">,</span> <span class="token string">"[^a-zA-Z0-9]"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> cxManTyped <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">IsNull</span><span class="token punctuation">(</span><span class="token string">"CXMANTYPED"</span><span class="token punctuation">)</span> <span class="token punctuation">?</span> <span class="token keyword">null</span> <span class="token punctuation">:</span> Regex<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">"CXMANTYPED"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token class-name"><span class="token keyword">string</span> <span class="token punctuation">?</span></span><span class="token punctuation">?</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">,</span> <span class="token string">"[^a-zA-Z0-9]"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Skip rows if cleaned values are still empty</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>cxManufacturerNum<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>cxManTyped<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// Skip this row</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Create a MaximoData object with the row's data</span>
            <span class="token class-name"><span class="token keyword">var</span></span> maximoData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MaximoData</span>
            <span class="token punctuation">{</span>
                ITEMNUM <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToInt64</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">"ITEMNUM"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                DESCRIPTION <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">"DESCRIPTION"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token class-name"><span class="token keyword">string</span></span><span class="token punctuation">,</span>
                STATUS <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">"STATUS"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token class-name"><span class="token keyword">string</span></span><span class="token punctuation">,</span>
                LOCATION <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">"LOCATION"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token class-name"><span class="token keyword">string</span></span><span class="token punctuation">,</span>
                CXMANUFACTURERNUM <span class="token operator">=</span> cxManufacturerNum<span class="token punctuation">,</span>
                CXMANTYPED <span class="token operator">=</span> cxManTyped<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token comment">// Add the MaximoData object to the MaximoList</span>
            MaximoList<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>maximoData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Update the MaximoGrid's ItemsSource to display the results</span>
        MaximoGrid<span class="token punctuation">.</span>ItemsSource <span class="token operator">=</span> resultsODBC<span class="token punctuation">.</span>DefaultView<span class="token punctuation">;</span>

        <span class="token comment">// Enable the Browse button</span>
        BTN_Browse<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

        <span class="token comment">// Set the second checkbox to checked state</span>
        Check2<span class="token punctuation">.</span>IsChecked <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Show an error message if an exception occurs</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"An error occurred: "</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="MDL COMPARATOR" dir="auto" class="heading" id="MDL_COMPARATOR">MDL COMPARATOR</h1><div class="heading-children"><div class="el-h2 heading-wrapper"><h2 data-heading="Button Browse" dir="auto" class="heading" id="Button_Browse"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Button Browse</h2><div class="heading-children"><div class="el-p"><p dir="auto">This code defines an asynchronous event handler <a href="?query=tag:Button_Browse" class="tag" target="_blank" rel="noopener nofollow">#Button_Browse</a> that is triggered when the "Browse" button is clicked in a WPF application. Its main purpose is to allow the user to select an Excel file, read its contents asynchronously, update the user interface (UI), and prepare the application for further processing. Here's a breakdown of the key steps:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>File Selection</strong>:
<ul>
<li data-line="1" dir="auto"><strong>Open File Dialog</strong>: Initializes an <code>OpenFileDialog</code> that allows users to browse and select an Excel file (<code>*.xlsx</code> or <code>*.xlsm</code>). The dialog only shows these supported file types.</li>
<li data-line="2" dir="auto"><strong>User Selection</strong>: Opens the file dialog and waits for the user to select a file. The user's selection is stored in the variable <code>result</code>.</li>
<li data-line="3" dir="auto"><strong>Store File Path</strong>: If a file is successfully selected (<code>result == true</code>), the full file path is stored in <code>selectedFilePath</code>.</li>
<li data-line="4" dir="auto"></li>
</ul>
</li>
<li data-line="5" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>UI Reset</strong>:    
<ul>
<li data-line="6" dir="auto"><strong>Clear Labels and Grids</strong>: Resets various UI components like labels (<code>percentagePart</code>, <code>foundPart</code>, <code>uniqueMdl</code>) and data grids (<code>MatchGrid</code>, <code>FuzzyMatchGrid</code>). This ensures that any previous data or results are cleared out before the new file's data is processed.</li>
</ul>
</li>
<li data-line="8" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Progress Indicator Initialization</strong>:    
<ul>
<li data-line="9" dir="auto"><strong>Disable Browse Button</strong>: The "Browse" button is disabled (<code>browseButton.IsEnabled = false</code>) to prevent users from selecting another file while the current operation is running.</li>
<li data-line="10" dir="auto"><strong>Show Progress on Browse Button</strong>: A progress indicator is added to the "Browse" button to visually inform users that a background task is in progress (<code>ButtonProgressAssist.SetIsIndeterminate</code> and <code>ButtonProgressAssist.SetIsIndicatorVisible</code>).</li>
</ul>
</li>
<li data-line="12" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Asynchronous Data Reading</strong>:    
<ul>
<li data-line="13" dir="auto"><strong>Read Excel Data</strong>: The selected Excel file is read asynchronously using <code>Task.Run(...)</code>. This is done to prevent blocking the UI while reading large files.</li>
<li data-line="14" dir="auto"><strong>Error Handling During Reading</strong>: If an error occurs during the file read operation, it is caught, logged, and a default value (<code>null, null, 0</code>) is returned to indicate failure (<code>Debug.WriteLine</code> for logging).</li>
</ul>
</li>
<li data-line="16" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Data Storage and Verification</strong>:    
<ul>
<li data-line="17" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Store Results</strong>: Stores the returned data from <a href="?query=tag:ExcelHelper" class="tag" target="_blank" rel="noopener nofollow">#ExcelHelper</a>.ReadExcelData(...)` into variables:
<ul>
<li data-line="18" dir="auto"><code>mdlTable</code>: Stores the data table from the Excel file.</li>
<li data-line="19" dir="auto"><code>mdlTableUnfiltered</code>: Stores the unfiltered version of the data.</li>
<li data-line="20" dir="auto"><code>yCount</code>: Stores the total row count from the Excel file.</li>
</ul>
</li>
<li data-line="21" dir="auto"><strong>Data Verification</strong>: Checks if <code>mdlTable</code> is not null and contains rows. If <code>mdlTable</code> is empty, an error message is shown to the user indicating the data read failure (<code>MessageBox.Show</code>), and the method exits after resetting the button and progress indicator states.</li>
</ul>
</li>
<li data-line="23" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Enable Related UI Elements</strong>:    
<ul>
<li data-line="24" dir="auto"><strong>Log Data Info</strong>: Outputs debug information about the number of rows (<code>Debug.WriteLine</code>).</li>
<li data-line="25" dir="auto"><strong>Enable Upload Button</strong>: Enables the "Upload Tool Tree" button (<code>BTN_UploadToolTree</code>) to allow further processing after the Excel file is loaded.</li>
<li data-line="26" dir="auto"><strong>Enable Process Button</strong>: If the <code>MaximoList</code> is not empty, the "Process" button (<code>BTN_Process</code>) is also enabled to proceed with further analysis or operations.</li>
</ul>
</li>
<li data-line="28" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Finalization</strong>:    
<ul>
<li data-line="29" dir="auto"><strong>Hide Progress Indicator</strong>: After successfully loading the data, the progress indicator on the "Browse" button is hidden (<code>SetIsIndeterminate</code> and <code>SetIsIndicatorVisible</code>).</li>
<li data-line="30" dir="auto"><strong>Disable Browse Button</strong>: Disables the "Browse" button to prevent selecting multiple files after a successful load (<code>browseButton.IsEnabled = false</code>).</li>
</ul>
</li>
<li data-line="32" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Error Handling and User Notifications</strong>:    
<ul>
<li data-line="33" dir="auto"><strong>No File Selected</strong>: If the user cancels the file selection dialog, a warning message is shown (<code>"No file selected. Please select an Excel file."</code>), and the "Browse" button is re-enabled.</li>
<li data-line="34" dir="auto"><strong>Unexpected Errors</strong>: If any other exceptions occur, an error message is displayed to the user (<code>MessageBox.Show</code>), and the "Browse" button is re-enabled to allow the user to retry.</li>
</ul>
</li>
</ul></div><div class="el-pre"><pre class="language-csharp" tabindex="0"><code data-line="0" class="language-csharp is-loaded">      <span class="token comment">// Button click event handler for browsing and selecting an Excel file</span>
<span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Button_Browse</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">RoutedEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> browseButton <span class="token operator">=</span> sender <span class="token keyword">as</span> <span class="token class-name">Button</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>browseButton <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Disable the browse button to prevent multiple clicks</span>
        browseButton<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    progressValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">// Show file dialog to select Excel file</span>
    <span class="token class-name">OpenFileDialog</span> openFileDialog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OpenFileDialog</span>
    <span class="token punctuation">{</span>
        Filter <span class="token operator">=</span> <span class="token string">"Excel files (*.xlsx;*.xlsm)|*.xlsx;*.xlsm"</span> <span class="token comment">// Only show Excel files in the file dialog</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">bool</span><span class="token punctuation">?</span></span> result <span class="token operator">=</span> openFileDialog<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Reset labels and grid views to initial empty state</span>
    percentagePart<span class="token punctuation">.</span>Content <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    foundPart<span class="token punctuation">.</span>Content <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    uniqueMdl<span class="token punctuation">.</span>Content <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    MatchGrid<span class="token punctuation">.</span>ItemsSource <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    FuzzyMatchGrid<span class="token punctuation">.</span>ItemsSource <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            selectedFilePath <span class="token operator">=</span> openFileDialog<span class="token punctuation">.</span>FileName<span class="token punctuation">;</span> <span class="token comment">// Store the selected file path</span>

            <span class="token comment">// Show progress indicator on Browse button</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>browseButton <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndeterminate</span><span class="token punctuation">(</span>browseButton<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Set progress indicator to indeterminate</span>
                ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndicatorVisible</span><span class="token punctuation">(</span>browseButton<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Show the progress indicator</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Read Excel data asynchronously using a separate task</span>
            <span class="token class-name"><span class="token keyword">var</span></span> resultExcel <span class="token operator">=</span> <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">try</span>
                <span class="token punctuation">{</span>
                    <span class="token comment">// Read data from the selected Excel file</span>
                    <span class="token keyword">return</span> ExcelHelper<span class="token punctuation">.</span><span class="token function">ReadExcelData</span><span class="token punctuation">(</span>selectedFilePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error reading Excel file: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Return default values in case of an error</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Extract data from the result</span>
            mdlTable <span class="token operator">=</span> resultExcel<span class="token punctuation">.</span>Item1<span class="token punctuation">;</span> <span class="token comment">// Store the data from the Excel file in mdlTable</span>
            mdlTableUnfiltered <span class="token operator">=</span> resultExcel<span class="token punctuation">.</span>Item2<span class="token punctuation">;</span> <span class="token comment">// Store unfiltered data from the Excel file</span>
            yCount <span class="token operator">=</span> resultExcel<span class="token punctuation">.</span>Item3<span class="token punctuation">;</span> <span class="token comment">// Store the row count from the Excel file</span>

            <span class="token comment">// Check if data has been successfully read</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>mdlTable <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> mdlTable<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Rows in DataTable after Task.Run: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">mdlTable<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{</span>
                <span class="token comment">// If no data is read, show error message</span>
                Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"mdlTable is null or empty."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"Failed to read the data from the selected file. Please select a valid Excel file."</span><span class="token punctuation">,</span> <span class="token string">"File Error"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>browseButton <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    browseButton<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// Re-enable the browse button</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Hide progress indicators</span>
                ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndeterminate</span><span class="token punctuation">(</span>browseButton<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndicatorVisible</span><span class="token punctuation">(</span>browseButton<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">// Exit the method</span>
            <span class="token punctuation">}</span>

            Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Total Rows: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">mdlTable<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            BTN_UploadToolTree<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// Enable Upload button once data is loaded</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>MaximoList<span class="token punctuation">.</span>Count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                BTN_Process<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// Enable Process button if MaximoList has elements</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Hide the progress indicator once data loading is complete</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>browseButton <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndeterminate</span><span class="token punctuation">(</span>browseButton<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Set progress indicator to determinate</span>
                ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndicatorVisible</span><span class="token punctuation">(</span>browseButton<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hide the progress indicator</span>
                browseButton<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// Disable the Browse button after successful file selection</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// No file was selected, or the user canceled the dialog</span>
            MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"No file selected. Please select an Excel file."</span><span class="token punctuation">,</span> <span class="token string">"File Selection"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Warning<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>browseButton <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                browseButton<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// Re-enable the browse button</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Handle unexpected errors</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"An error occurred: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">\nPlease try selecting the file again."</span></span><span class="token punctuation">,</span> <span class="token string">"Error"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>browseButton <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            browseButton<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// Re-enable the browse button</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Hide progress indicators if an error occurs</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>browseButton <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndeterminate</span><span class="token punctuation">(</span>browseButton<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndicatorVisible</span><span class="token punctuation">(</span>browseButton<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Button Process" dir="auto" class="heading" id="Button_Process"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Button Process</h2><div class="heading-children"><div class="el-p"><p dir="auto">The <a href="?query=tag:Button_Process" class="tag" target="_blank" rel="noopener nofollow">#Button_Process</a> method is an asynchronous event handler triggered when the "Process" button is clicked. It performs data matching and comparison tasks, updates the UI with results, handles progress indicators, and utilizes a console manager to display processing messages. Here's a breakdown of the key steps:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Disable Buttons and Start Progress Indicator</strong>:    
<ul>
<li data-line="1" dir="auto">Disables the "Process" and "Browse" buttons to prevent the user from interacting with them during processing.</li>
<li data-line="2" dir="auto">Activates a progress indicator on the "Process" button to show that work is in progress.</li>
</ul>
</li>
<li data-line="4" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Capture User Selections</strong>:    
<ul>
<li data-line="5" dir="auto">Retrieves filter settings from various checkboxes (<code>Box_Filter</code>, <code>Box_Filler</code>, <code>Box_Doubles</code>) to configure the task's parameters.</li>
</ul>
</li>
<li data-line="7" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Asynchronous Processing Task</strong>:    
<ul>
<li data-line="8" dir="auto">The code runs a background task using <code>Task.Run()</code> to avoid blocking the user interface.</li>
<li data-line="9" dir="auto">A progress reporter (<code>progressReporter</code>) is used to update the UI with progress changes.</li>
<li data-line="10" dir="auto">The <code>Matcher</code> class is used to perform matching operations on the input data (<code>mdlTable</code>, <code>MaximoList</code>), resulting in three output lists (<code>exactMatchedList</code>, <code>fuzzyMatchedList</code>, <code>unmatchedManufacturerNumsList</code>)</li>
</ul>
</li>
<li data-line="12" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Update the User Interface</strong>:    
<ul>
<li data-line="13" dir="auto">After matching, the <code>exactMatchedList</code> and <code>fuzzyMatchedList</code> are used to update two UI grids (<code>MatchGrid</code> and <code>FuzzyMatchGrid</code>) via the <code>Dispatcher</code> to ensure thread-safe UI updates.</li>
<li data-line="14" dir="auto">It also calls <a href="?query=tag:ExcelHelper" class="tag" target="_blank" rel="noopener nofollow">#ExcelHelper</a>.CompareFunction()` to compare and color cells in an Excel file, returning the matched and unmatched cell counts.</li>
<li data-line="15" dir="auto">These counts are used to update UI labels (<code>uniqueMdl</code>, <code>foundPart</code>, <code>percentagePart</code>) to show the total count, the number of matched parts, and the matching percentage.</li>
</ul>
</li>
<li data-line="17" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Error Handling</strong>:    
<ul>
<li data-line="18" dir="auto">Catches any exceptions that may occur during the process and displays an error message to the user.</li>
<li data-line="19" dir="auto">Logs errors to the debug output (<code>Debug.WriteLine</code>) for troubleshooting.</li>
</ul>
</li>
<li data-line="21" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Re-enable Buttons and Stop Progress Indicator</strong>:   
<ul>
<li data-line="22" dir="auto">In the <code>finally</code> block, the code stops the progress indicator on the "Process" button and re-enables the "Browse" button.</li>
<li data-line="23" dir="auto">Opens the processed Excel file using the <a href="?query=tag:FileOpener" class="tag" target="_blank" rel="noopener nofollow">#FileOpener</a>` class.</li>
<li data-line="24" dir="auto">Clears the selected file path to reset the state.</li>
</ul>
</li>
</ul></div><div class="el-pre"><pre class="language-csharp" tabindex="0"><code data-line="0" class="language-csharp is-loaded">    <span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Button_Process</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">RoutedEventArgs</span> e<span class="token punctuation">)</span>
 <span class="token punctuation">{</span>
     <span class="token comment">// Disable the Process button to prevent multiple clicks</span>
     BTN_Process<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

     <span class="token keyword">try</span>
     <span class="token punctuation">{</span>
         <span class="token comment">// Disable the Browse button during processing</span>
         BTN_Browse<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

         <span class="token comment">// Show progress indicator on the Process button</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>sender <span class="token keyword">is</span> <span class="token class-name">Button</span> BTN_Process<span class="token punctuation">)</span>
         <span class="token punctuation">{</span>
             ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndeterminate</span><span class="token punctuation">(</span>BTN_Process<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndicatorVisible</span><span class="token punctuation">(</span>BTN_Process<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>

         <span class="token comment">// Capture filter settings before starting the task</span>
         <span class="token class-name"><span class="token keyword">bool</span></span> isBoxFilterChecked <span class="token operator">=</span> Box_Filter<span class="token punctuation">.</span>IsChecked <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
         <span class="token class-name"><span class="token keyword">bool</span></span> boxFillerChecked <span class="token operator">=</span> Box_Filler<span class="token punctuation">.</span>IsChecked <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
         <span class="token class-name"><span class="token keyword">bool</span></span> isDoublesChecked <span class="token operator">=</span> Box_Doubles<span class="token punctuation">.</span>IsChecked <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// Checkbox for handling duplicates</span>

         <span class="token comment">// Create a progress reporter to update the UI with progress</span>
         <span class="token class-name"><span class="token keyword">var</span></span> progressReporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Progress<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>progressValue <span class="token operator">=&gt;</span>
         <span class="token punctuation">{</span>
             <span class="token comment">// Update your progress bar or any UI component showing progress</span>
             Application<span class="token punctuation">.</span>Current<span class="token punctuation">.</span>Dispatcher<span class="token punctuation">.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
             <span class="token punctuation">{</span>
                 ProgressValue <span class="token operator">=</span> progressValue<span class="token punctuation">;</span> <span class="token comment">// Update ProgressBar's value</span>
             <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// Asynchronous task to perform matching</span>
         <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
         <span class="token punctuation">{</span>
             <span class="token keyword">try</span>
             <span class="token punctuation">{</span>
                 <span class="token comment">// Perform matching using Matcher class</span>
                 <span class="token class-name"><span class="token keyword">var</span></span> matcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Matcher</span><span class="token punctuation">(</span>mdlTable<span class="token punctuation">,</span> MaximoList<span class="token punctuation">,</span> isBoxFilterChecked<span class="token punctuation">,</span> progressReporter<span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token keyword">var</span> <span class="token punctuation">(</span>exactMatchedList<span class="token punctuation">,</span> fuzzyMatchedList<span class="token punctuation">,</span> unmatchedManufacturerNumsList<span class="token punctuation">)</span> <span class="token operator">=</span> matcher<span class="token punctuation">.</span><span class="token function">PerformMatching</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                 <span class="token comment">// Update UI with matched results</span>
                 Application<span class="token punctuation">.</span>Current<span class="token punctuation">.</span>Dispatcher<span class="token punctuation">.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                 <span class="token punctuation">{</span>
                     MatchGrid<span class="token punctuation">.</span>ItemsSource <span class="token operator">=</span> exactMatchedList<span class="token punctuation">;</span>
                     FuzzyMatchGrid<span class="token punctuation">.</span>ItemsSource <span class="token operator">=</span> fuzzyMatchedList<span class="token punctuation">;</span>
                     ProgressValue <span class="token operator">=</span> progressValue<span class="token punctuation">;</span>
                 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                 Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Amount in ExactMatchedList :</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">exactMatchedList<span class="token punctuation">.</span>Count</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Amount in FuzzyMatchedList :</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">fuzzyMatchedList<span class="token punctuation">.</span>Count</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                 <span class="token comment">// Compare function to match and color cells in Excel, returning matched and unmatched counts</span>
                 <span class="token class-name"><span class="token keyword">var</span></span> coloredCells <span class="token operator">=</span> ExcelHelper<span class="token punctuation">.</span><span class="token function">CompareFunction</span><span class="token punctuation">(</span>selectedFilePath<span class="token punctuation">,</span> exactMatchedList<span class="token punctuation">,</span> fuzzyMatchedList<span class="token punctuation">,</span> unmatchedManufacturerNumsList<span class="token punctuation">,</span> boxFillerChecked<span class="token punctuation">,</span> isDoublesChecked<span class="token punctuation">)</span><span class="token punctuation">;</span>

                 <span class="token class-name"><span class="token keyword">int</span></span> matchedCells <span class="token operator">=</span> coloredCells<span class="token punctuation">.</span>Item1<span class="token punctuation">;</span> <span class="token comment">// Matched cells count</span>
                 <span class="token class-name"><span class="token keyword">int</span></span> unmatchedCells <span class="token operator">=</span> coloredCells<span class="token punctuation">.</span>Item2<span class="token punctuation">;</span> <span class="token comment">// Unmatched cells count</span>
                 <span class="token class-name"><span class="token keyword">int</span></span> percentage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>matchedCells <span class="token operator">/</span> <span class="token punctuation">(</span>matchedCells <span class="token operator">+</span> unmatchedCells<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Calculate matching percentage</span>

                 <span class="token comment">// Update UI with counts and percentage</span>
                 Application<span class="token punctuation">.</span>Current<span class="token punctuation">.</span>Dispatcher<span class="token punctuation">.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                 <span class="token punctuation">{</span>
                     uniqueMdl<span class="token punctuation">.</span>Content <span class="token operator">=</span> matchedCells <span class="token operator">+</span> unmatchedCells<span class="token punctuation">;</span> <span class="token comment">// Total count</span>
                     foundPart<span class="token punctuation">.</span>Content <span class="token operator">=</span> matchedCells<span class="token punctuation">;</span> <span class="token comment">// Found parts count</span>
                     percentagePart<span class="token punctuation">.</span>Content <span class="token operator">=</span> percentage<span class="token punctuation">;</span> <span class="token comment">// Matching percentage</span>
                     ProgressValue <span class="token operator">=</span> progressValue<span class="token punctuation">;</span>
                 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
             <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
             <span class="token punctuation">{</span>
                 Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error 2 during processing: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 Application<span class="token punctuation">.</span>Current<span class="token punctuation">.</span>Dispatcher<span class="token punctuation">.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                 <span class="token punctuation">{</span>
                     MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"An error occurred during processing. Please try again."</span><span class="token punctuation">,</span> <span class="token string">"Error"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
         Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error occurred: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         Application<span class="token punctuation">.</span>Current<span class="token punctuation">.</span>Dispatcher<span class="token punctuation">.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
         <span class="token punctuation">{</span>
             MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"An error occurred while starting the task. Please try again."</span><span class="token punctuation">,</span> <span class="token string">"Error"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">finally</span>
     <span class="token punctuation">{</span>
         <span class="token comment">// Re-enable Browse button and stop the progress indicator on Process button</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>sender <span class="token keyword">is</span> <span class="token class-name">Button</span> BTN_Process<span class="token punctuation">)</span>
         <span class="token punctuation">{</span>
             ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndeterminate</span><span class="token punctuation">(</span>BTN_Process<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndicatorVisible</span><span class="token punctuation">(</span>BTN_Process<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>

         BTN_Browse<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

         <span class="token comment">// Open the processed Excel file</span>
         <span class="token class-name">FileOpener</span> fileOpener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileOpener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         fileOpener<span class="token punctuation">.</span><span class="token function">OpenFile</span><span class="token punctuation">(</span>selectedFilePath<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// Clear the selected file path</span>
         selectedFilePath <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Keydown" dir="auto" class="heading" id="Keydown"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Keydown</h2><div class="heading-children"><div class="el-p"><p dir="auto">This code defines four event handlers for the <code>KeyDown</code> event on various input fields in the user interface. The purpose of each event handler is to trigger a search action when the user presses the Enter key while focusing on one of the input fields:</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><strong>Input Fields</strong>: The handlers are attached to the <code>ItemNum</code>, <code>Description</code>, <code>ManuFacturerNum</code>, and <code>Type</code> input fields.</li>
<li data-line="2" dir="auto"><strong>Enter Key Check</strong>: Each event handler checks if the key pressed by the user is the Enter key (<code>Key.Enter</code>).</li>
<li data-line="4" dir="auto"><strong>Perform Search</strong>: If the Enter key is pressed, the <a href="?query=tag:PerformSearch" class="tag" target="_blank" rel="noopener nofollow">#PerformSearch</a> method is called, which initiates a search action. This allows users to quickly perform searches without having to click a separate search button.</li>
</ol></div><div class="el-pre"><pre class="language-csharp" tabindex="0"><code data-line="0" class="language-csharp is-loaded"><span class="token comment">// Event handler for the KeyDown event on the ItemNum input field</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ItemNum_KeyDown</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">KeyEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Check if the Enter key was pressed</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>Key <span class="token operator">==</span> Key<span class="token punctuation">.</span>Enter<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">PerfomSearch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Call the PerformSearch method</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Event handler for the KeyDown event on the Description input field</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Description_KeyDown</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">KeyEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Check if the Enter key was pressed</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>Key <span class="token operator">==</span> Key<span class="token punctuation">.</span>Enter<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">PerfomSearch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Call the PerformSearch method</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Event handler for the KeyDown event on the ManuFacturerNum input field</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ManuFacturerNum_KeyDown</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">KeyEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Check if the Enter key was pressed</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>Key <span class="token operator">==</span> Key<span class="token punctuation">.</span>Enter<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">PerfomSearch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Call the PerformSearch method</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Event handler for the KeyDown event on the Type input field</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Type_KeyDown</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">KeyEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Check if the Enter key was pressed</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>Key <span class="token operator">==</span> Key<span class="token punctuation">.</span>Enter<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">PerfomSearch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Call the PerformSearch method</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Perform Search" dir="auto" class="heading" id="Perform_Search"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Perform Search</h2><div class="heading-children"><div class="el-p"><p dir="auto">The <a href="?query=tag:PerformSearch" class="tag" target="_blank" rel="noopener nofollow">#PerformSearch</a>  method handles search functionality for a data grid based on user input from various text boxes. It retrieves search terms, checks if any terms are provided, applies search filters using the specified terms, and updates the grid with the filtered results. Here are the key steps:</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><strong>Retrieve and Clean Input</strong>: It collects search terms from the <code>ItemNum</code>, <code>Description</code>, <code>ManuFacturerNum</code>, and <code>Type</code> input fields, trimming whitespace.</li>
<li data-line="2" dir="auto"><strong>Validation</strong>: If all search terms are empty, the method shows a message prompting the user to enter a search term and exits.</li>
<li data-line="4" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Search Term Processing</strong>:
<ul>
<li data-line="5" dir="auto">It converts wildcard search terms (using <code>*</code> or <code>%</code>) into regular expressions using a helper function.</li>
<li data-line="6" dir="auto">It also checks if search terms contain wildcards or require keyword matching.</li>
</ul>
</li>
<li data-line="8" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Filtering</strong>:
<ul>
<li data-line="9" dir="auto">It filters the dataset (<code>resultsODBC</code>) based on each search term, using either regex or keyword matching as needed.</li>
<li data-line="10" dir="auto">Filtering is applied across item number, description, manufacturer number, and type fields.</li>
</ul>
</li>
<li data-line="12" dir="auto"><strong>Result Formatting</strong>: If results are found, they are formatted by padding string fields for display consistency in the grid.</li>
<li data-line="14" dir="auto"><strong>Update UI</strong>: The filtered and formatted results are then bound to the <code>MaximoGrid</code>, updating the display to show only the rows matching the search criteria.</li>
</ol></div><div class="el-pre"><pre class="language-csharp" tabindex="0"><code data-line="0" class="language-csharp is-loaded"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PerfomSearch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Retrieve search terms from the text boxes and trim whitespace</span>
    <span class="token class-name"><span class="token keyword">string</span></span> itemNumValue <span class="token operator">=</span> ItemNum<span class="token punctuation">.</span>Text<span class="token punctuation">?.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">string</span></span> descriptionValue <span class="token operator">=</span> Description<span class="token punctuation">.</span>Text<span class="token punctuation">?.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">string</span></span> manufacturerNumValue <span class="token operator">=</span> ManuFacturerNum<span class="token punctuation">.</span>Text<span class="token punctuation">?.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">string</span></span> typeValue <span class="token operator">=</span> Type<span class="token punctuation">.</span>Text<span class="token punctuation">?.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">;</span>

    <span class="token comment">// Check if all search terms are empty and show a message if so</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrWhiteSpace</span><span class="token punctuation">(</span>itemNumValue<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrWhiteSpace</span><span class="token punctuation">(</span>descriptionValue<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrWhiteSpace</span><span class="token punctuation">(</span>manufacturerNumValue<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrWhiteSpace</span><span class="token punctuation">(</span>typeValue<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"Please enter a search term"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Alert the user to enter at least one search term</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">// Exit the method if no search terms are provided</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Helper function to convert wildcard characters (*) and (%) to regex patterns</span>
    <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">WildcardToRegex</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"^"</span> <span class="token operator">+</span> Regex<span class="token punctuation">.</span><span class="token function">Escape</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"\\*"</span><span class="token punctuation">,</span> <span class="token string">".*"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"\\%"</span><span class="token punctuation">,</span> <span class="token string">".*"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"$"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Helper function to check if the search term contains wildcard characters</span>
    <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">ContainsWildcard</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">value</span><span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token char">'*'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">value</span><span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token char">'%'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Helper function to check if all keywords from the search term are present in the target string</span>
    <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">ContainsAllKeywords</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> target<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> search<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> keywords <span class="token operator">=</span> search<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span><span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token char">' '</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> StringSplitOptions<span class="token punctuation">.</span>RemoveEmptyEntries<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> keywords<span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span>keyword <span class="token operator">=&gt;</span> target<span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span>keyword<span class="token punctuation">,</span> StringComparison<span class="token punctuation">.</span>OrdinalIgnoreCase<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Start with all available results or an empty set if resultsODBC is null</span>
    <span class="token class-name"><span class="token keyword">var</span></span> searchResults <span class="token operator">=</span> resultsODBC<span class="token punctuation">?.</span><span class="token function">AsEnumerable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">??</span> Enumerable<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Empty</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>DataRow<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Apply filters based on the item number search term</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrWhiteSpace</span><span class="token punctuation">(</span>itemNumValue<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ContainsWildcard</span><span class="token punctuation">(</span>itemNumValue<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Check if the search term contains wildcards</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">string</span></span> itemNumPattern <span class="token operator">=</span> <span class="token function">WildcardToRegex</span><span class="token punctuation">(</span>itemNumValue<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Convert the search term to regex</span>
            searchResults <span class="token operator">=</span> searchResults<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> Regex<span class="token punctuation">.</span><span class="token function">IsMatch</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"ITEMNUM"</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">,</span> itemNumPattern<span class="token punctuation">,</span> RegexOptions<span class="token punctuation">.</span>IgnoreCase<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            searchResults <span class="token operator">=</span> searchResults<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> <span class="token function">ContainsAllKeywords</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"ITEMNUM"</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">,</span> itemNumValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Apply filters based on the description search term</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrWhiteSpace</span><span class="token punctuation">(</span>descriptionValue<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ContainsWildcard</span><span class="token punctuation">(</span>descriptionValue<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">string</span></span> descriptionPattern <span class="token operator">=</span> <span class="token function">WildcardToRegex</span><span class="token punctuation">(</span>descriptionValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
            searchResults <span class="token operator">=</span> searchResults<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> Regex<span class="token punctuation">.</span><span class="token function">IsMatch</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"DESCRIPTION"</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">,</span> descriptionPattern<span class="token punctuation">,</span> RegexOptions<span class="token punctuation">.</span>IgnoreCase<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            searchResults <span class="token operator">=</span> searchResults<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> <span class="token function">ContainsAllKeywords</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"DESCRIPTION"</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">,</span> descriptionValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Apply filters based on the manufacturer number search term</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrWhiteSpace</span><span class="token punctuation">(</span>manufacturerNumValue<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ContainsWildcard</span><span class="token punctuation">(</span>manufacturerNumValue<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">string</span></span> manufacturerNumPattern <span class="token operator">=</span> <span class="token function">WildcardToRegex</span><span class="token punctuation">(</span>manufacturerNumValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
            searchResults <span class="token operator">=</span> searchResults<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> Regex<span class="token punctuation">.</span><span class="token function">IsMatch</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"CXMANUFACTURERNUM"</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">,</span> manufacturerNumPattern<span class="token punctuation">,</span> RegexOptions<span class="token punctuation">.</span>IgnoreCase<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            searchResults <span class="token operator">=</span> searchResults<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> <span class="token function">ContainsAllKeywords</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"CXMANUFACTURERNUM"</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">,</span> manufacturerNumValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Apply filters based on the type search term</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrWhiteSpace</span><span class="token punctuation">(</span>typeValue<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ContainsWildcard</span><span class="token punctuation">(</span>typeValue<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">string</span></span> typePattern <span class="token operator">=</span> <span class="token function">WildcardToRegex</span><span class="token punctuation">(</span>typeValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
            searchResults <span class="token operator">=</span> searchResults<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> Regex<span class="token punctuation">.</span><span class="token function">IsMatch</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"CXMANTYPED"</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">,</span> typePattern<span class="token punctuation">,</span> RegexOptions<span class="token punctuation">.</span>IgnoreCase<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            searchResults <span class="token operator">=</span> searchResults<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> <span class="token function">ContainsAllKeywords</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"CXMANTYPED"</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">,</span> typeValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Convert the filtered results back to a DataTable</span>
    <span class="token class-name">DataTable</span> filteredResults <span class="token operator">=</span> searchResults<span class="token punctuation">.</span><span class="token function">Any</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">?</span> searchResults<span class="token punctuation">.</span><span class="token function">CopyToDataTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Apply formatting to the columns by padding strings for display consistency</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">DataRow</span> row <span class="token keyword">in</span> filteredResults<span class="token punctuation">.</span>Rows<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        row<span class="token punctuation">[</span><span class="token string">"DESCRIPTION"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">"DESCRIPTION"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token class-name"><span class="token keyword">string</span></span><span class="token punctuation">)</span><span class="token punctuation">?.</span><span class="token function">PadRight</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        row<span class="token punctuation">[</span><span class="token string">"CXMANUFACTURERNUM"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">"CXMANUFACTURERNUM"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token class-name"><span class="token keyword">string</span></span><span class="token punctuation">)</span><span class="token punctuation">?.</span><span class="token function">PadRight</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        row<span class="token punctuation">[</span><span class="token string">"CXMANTYPED"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">"CXMANTYPED"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token class-name"><span class="token keyword">string</span></span><span class="token punctuation">)</span><span class="token punctuation">?.</span><span class="token function">PadRight</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Bind the filtered results to the MaximoGrid for display</span>
    MaximoGrid<span class="token punctuation">.</span>ItemsSource <span class="token operator">=</span> filteredResults<span class="token punctuation">.</span>DefaultView<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Button Reset Fields" dir="auto" class="heading" id="Button_Reset_Fields"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Button Reset Fields</h2><div class="heading-children"><div class="el-p"><p dir="auto"><a href="?query=tag:Button_Reset_Fields" class="tag" target="_blank" rel="noopener nofollow">#Button_Reset_Fields</a> This method is invoked when a button is clicked, typically a "Reset" button, to clear search inputs and reset a data grid.</p></div><div class="el-pre"><pre class="language-csharp" tabindex="0"><code data-line="0" class="language-csharp is-loaded">  <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Button_Reset_Fields</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">RoutedEventArgs</span> e<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
      <span class="token comment">// Clear all textboxes for search input</span>
      ItemNum<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
      Description<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
      ManuFacturerNum<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
      Type<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>

      <span class="token comment">// Reset the MaximoGrid data to the original ODBC results</span>
      MaximoGrid<span class="token punctuation">.</span>ItemsSource <span class="token operator">=</span> resultsODBC<span class="token punctuation">?.</span>DefaultView<span class="token punctuation">;</span>
      filteredResults<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Button Export" dir="auto" class="heading" id="Button_Export"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Button Export</h2><div class="heading-children"><div class="el-p"><p dir="auto"><a href="?query=tag:Button_Export" class="tag" target="_blank" rel="noopener nofollow">#Button_Export</a>. It is used to export the data to an Excel file when a button (likely an "Export" button) is clicked.</p></div><div class="el-pre"><pre class="language-csharp" tabindex="0"><code data-line="0" class="language-csharp is-loaded">    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Button_Export</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">RoutedEventArgs</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Assuming filteredResults and resultsODBC are both of type DataTable</span>
        <span class="token class-name">DataTable</span> dataToExport <span class="token operator">=</span> filteredResults <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> filteredResults<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">?</span> filteredResults <span class="token punctuation">:</span> resultsODBC<span class="token punctuation">;</span>

        <span class="token comment">// Inform the user if there is no data to export</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>dataToExport <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> dataToExport<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"There is no data to export."</span><span class="token punctuation">,</span> <span class="token string">"Empty Data"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Warning<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Create an instance of ExcelExporter and export the selected DataTable</span>
        <span class="token class-name">ExcelExporter</span> excelExporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ExcelExporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelExporter<span class="token punctuation">.</span><span class="token function">ExportDataTableToExcelWithDialog</span><span class="token punctuation">(</span>dataToExport<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>




</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="TOOLTREE  GENERATOR" dir="auto" class="heading" id="TOOLTREE__GENERATOR">TOOLTREE  GENERATOR</h1><div class="heading-children"><div class="el-h2 heading-wrapper"><h2 data-heading="Item class" dir="auto" class="heading" id="Item_class"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Item class</h2><div class="heading-children"><div class="el-p"><p dir="auto"><strong><code>Item</code> Class</strong>:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Represents an item with a property named <code>itemnum</code>, which is serialized and deserialized to/from JSON using the <code>JsonProperty</code> attribute.</li>
</ul></div><div class="el-pre"><pre class="language-csharp" tabindex="0"><code data-line="0" class="language-csharp is-loaded">   <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Item</span>
   <span class="token punctuation">{</span>
       <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">JsonProperty</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"itemnum"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
       <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">long</span></span> Itemnum <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="OnPropertyChanged" dir="auto" class="heading" id="OnPropertyChanged"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>OnPropertyChanged</h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong><code>OnPropertyChanged</code> Method</strong>:    
<ul>
<li data-line="1" dir="auto">Implements the <code>INotifyPropertyChanged</code> interface to notify when a property value changes, which is commonly used in data binding.</li>
</ul>
</li>
</ul></div><div class="el-pre"><pre class="language-csharp" tabindex="0"><code data-line="0" class="language-csharp is-loaded">   <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnPropertyChanged</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> propertyName<span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
       PropertyChanged<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PropertyChangedEventArgs</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Upload ToolTree" dir="auto" class="heading" id="Upload_ToolTree"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Upload ToolTree</h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong><code>Upload_Tooltree</code> Method</strong>:    
<ul>
<li data-line="1" dir="auto">Handles the upload of data from an Excel file to populate a "ToolTree."</li>
<li data-line="2" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Steps:</strong>
<ul>
<li data-line="3" dir="auto">Disables the upload button to prevent multiple clicks.</li>
<li data-line="4" dir="auto">Clears the existing items in the Tooltree.</li>
<li data-line="5" dir="auto">Opens a file dialog for the user to select an Excel file.</li>
<li data-line="6" dir="auto">Reads the selected Excel file asynchronously into a <code>DataTable</code>.</li>
<li data-line="7" dir="auto">Logs information about the rows in the Excel file and stores it for further use.</li>
<li data-line="8" dir="auto">Re-enables the button after the upload process is complete.</li>
<li data-line="9" dir="auto">Enables the "Generate ToolTree" button if the data (<code>mdlTable</code>) is available.</li>
</ul>
</li>
</ul>
</li>
</ul></div><div class="el-pre"><pre class="language-csharp" tabindex="0"><code data-line="0" class="language-csharp is-loaded">  <span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Upload_Tooltree</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">RoutedEventArgs</span> e<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
      <span class="token comment">// Disable the Upload button to prevent further clicks during the process</span>
      BTN_UploadToolTree<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

      <span class="token keyword">try</span>
      <span class="token punctuation">{</span>
          <span class="token comment">// Clear Tooltree.ItemsSource if it exists</span>
          <span class="token class-name"><span class="token keyword">var</span></span> itemsSource <span class="token operator">=</span> Tooltree<span class="token punctuation">.</span>ItemsSource <span class="token keyword">as</span> <span class="token class-name">IList<span class="token punctuation">&lt;</span><span class="token keyword">object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>itemsSource <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
              itemsSource<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>

          <span class="token comment">// Show file dialog to select an Excel file</span>
          <span class="token class-name">OpenFileDialog</span> openFileDialog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OpenFileDialog</span>
          <span class="token punctuation">{</span>
              Filter <span class="token operator">=</span> <span class="token string">"Excel files (*.xlsx;*.xlsm)|*.xlsx;*.xlsm"</span> <span class="token comment">// Only allow selection of Excel files</span>
          <span class="token punctuation">}</span><span class="token punctuation">;</span>
          <span class="token class-name"><span class="token keyword">bool</span><span class="token punctuation">?</span></span> result <span class="token operator">=</span> openFileDialog<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Show the dialog and capture the result</span>

          <span class="token comment">// If the user selects a file and clicks OK</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
              <span class="token comment">// Show progress indicator on the Upload button</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>sender <span class="token keyword">is</span> <span class="token class-name">Button</span> BTN_UploadToolTree<span class="token punctuation">)</span>
              <span class="token punctuation">{</span>
                  ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndeterminate</span><span class="token punctuation">(</span>BTN_UploadToolTree<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndicatorVisible</span><span class="token punctuation">(</span>BTN_UploadToolTree<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>

              <span class="token comment">// Store the selected file's path in the variable</span>
              selectedFilePathTree <span class="token operator">=</span> openFileDialog<span class="token punctuation">.</span>FileName<span class="token punctuation">;</span>

              <span class="token comment">// Read Excel data asynchronously using Task.Run</span>
              <span class="token comment">// ToolTreeHelper.ReadExcelData reads the Excel file and returns a DataTable</span>
              <span class="token class-name"><span class="token keyword">var</span></span> toolTreeExcel <span class="token operator">=</span> <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ToolTreeHelper<span class="token punctuation">.</span><span class="token function">ReadExcelData</span><span class="token punctuation">(</span>selectedFilePathTree<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

              <span class="token comment">// Check if the data was successfully read from the Excel file</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>toolTreeExcel <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
              <span class="token punctuation">{</span>
                  <span class="token comment">// Log the number of rows in the DataTable after the Task completes</span>
                  Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Rows in DataTable after Task.Run: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">toolTreeExcel<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                  <span class="token comment">// Assign the DataTable returned from the Excel to the toolTreeTable field</span>
                  toolTreeTable <span class="token operator">=</span> toolTreeExcel<span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
              <span class="token keyword">else</span>
              <span class="token punctuation">{</span>
                  <span class="token comment">// Log an error if the DataTable is null (Excel reading failed)</span>
                  Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"toolTreeExcel is null."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">// Exit the method if the data is null</span>
              <span class="token punctuation">}</span>

              <span class="token comment">// Log the contents of each row in the DataTable to the console</span>
              <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">DataRow</span> row <span class="token keyword">in</span> toolTreeTable<span class="token punctuation">.</span>Rows<span class="token punctuation">)</span>
              <span class="token punctuation">{</span>
                  <span class="token comment">// Handle null rows (this check prevents null reference exceptions)</span>
                  <span class="token keyword">if</span> <span class="token punctuation">(</span>row <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                  <span class="token punctuation">{</span>
                      <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// Skip processing for this row</span>
                  <span class="token punctuation">}</span>

                  <span class="token comment">// Build a string that contains all the column values in the row</span>
                  <span class="token class-name"><span class="token keyword">string</span></span> rowData <span class="token operator">=</span> <span class="token string">"Row: "</span><span class="token punctuation">;</span>
                  <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">DataColumn</span> column <span class="token keyword">in</span> toolTreeTable<span class="token punctuation">.</span>Columns<span class="token punctuation">)</span>
                  <span class="token punctuation">{</span>
                      rowData <span class="token operator">+=</span> <span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">row<span class="token punctuation">[</span>column<span class="token punctuation">]</span></span><span class="token punctuation">}</span></span><span class="token string"> "</span></span><span class="token punctuation">;</span> <span class="token comment">// Append each column's value to the rowData string</span>
                  <span class="token punctuation">}</span>

                  <span class="token comment">// Output the row data to the console</span>
                  Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>rowData<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>

              <span class="token comment">// Log the total number of rows in the DataTable</span>
              Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Total Rows: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">toolTreeTable<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
          Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error occurred: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"An error occurred during processing. Please try again."</span><span class="token punctuation">,</span> <span class="token string">"Error"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">finally</span>
      <span class="token punctuation">{</span>
          <span class="token comment">// Re-enable Upload button and stop the progress indicator on Upload button</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>sender <span class="token keyword">is</span> <span class="token class-name">Button</span> BTN_UploadToolTree<span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
              ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndeterminate</span><span class="token punctuation">(</span>BTN_UploadToolTree<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndicatorVisible</span><span class="token punctuation">(</span>BTN_UploadToolTree<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>

          <span class="token comment">//BTN_UploadToolTree.IsEnabled = true;</span>

          <span class="token comment">// Enable the Generate ToolTree button if mdlTable has rows</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>mdlTable<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
              BTN_Gen_ToolTree<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Generate ToolTree" dir="auto" class="heading" id="Generate_ToolTree"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Generate ToolTree</h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong><code>Generate_Tooltree</code> Method</strong>:    
<ul>
<li data-line="1" dir="auto">Handles the generation of a tool tree based on the uploaded data.</li>
<li data-line="2" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Steps:</strong>
<ul>
<li data-line="3" dir="auto">Disables the "Generate ToolTree" button to avoid multiple clicks.</li>
<li data-line="4" dir="auto">Shows a progress indicator.</li>
<li data-line="5" dir="auto">Uses a <code>ToolTreeGenerator</code> to create the tree structure (<code>ZonesList</code>).</li>
<li data-line="6" dir="auto">Enables a button named "Add Spare Parts."</li>
<li data-line="7" dir="auto">Expands all nodes of the TreeView.</li>
<li data-line="8" dir="auto">Converts the generated zones into a <code>DataTable</code> format for further use.</li>
</ul>
</li>
</ul>
</li>
</ul></div><div class="el-pre"><pre class="language-csharp" tabindex="0"><code data-line="0" class="language-csharp is-loaded"> <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Generate_Tooltree</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">RoutedEventArgs</span> e<span class="token punctuation">)</span>
 <span class="token punctuation">{</span>
     <span class="token comment">// Disable the Generate ToolTree button to prevent further clicks during processing</span>
     <span class="token comment">//BTN_GenerateToolTree.IsEnabled = false;</span>

     <span class="token keyword">try</span>
     <span class="token punctuation">{</span>
         <span class="token comment">// Show progress indicator on the Generate ToolTree button</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>sender <span class="token keyword">is</span> <span class="token class-name">Button</span> BTN_GenerateToolTree<span class="token punctuation">)</span>
         <span class="token punctuation">{</span>
             ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndeterminate</span><span class="token punctuation">(</span>BTN_GenerateToolTree<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndicatorVisible</span><span class="token punctuation">(</span>BTN_GenerateToolTree<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>

         <span class="token comment">// Instantiate the ToolTreeGenerator with the appropriate data tables</span>
         <span class="token class-name"><span class="token keyword">var</span></span> generator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ToolTreeGenerator</span><span class="token punctuation">(</span>toolTreeTable<span class="token punctuation">,</span> mdlTableUnfiltered<span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// Generate the zones collection</span>
         ZonesList <span class="token operator">=</span> generator<span class="token punctuation">.</span><span class="token function">GenerateZones</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// Enable the "Add Spare Parts" button after the ToolTree is generated</span>
         BTN_AddSpareParts<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

         <span class="token comment">// Expand all items in the TreeView</span>
         <span class="token function">ExpandTreeViewItems</span><span class="token punctuation">(</span>Tooltree<span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token class-name">TreeViewConverter</span> converter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">TreeViewConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         treeViewToTable <span class="token operator">=</span> converter<span class="token punctuation">.</span><span class="token function">ConvertZonesToDataTable</span><span class="token punctuation">(</span>ZonesList<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
         <span class="token comment">// Handle any errors during the generation process</span>
         Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error occurred during ToolTree generation: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"An error occurred while generating the ToolTree. Please try again."</span><span class="token punctuation">,</span> <span class="token string">"Error"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">finally</span>
     <span class="token punctuation">{</span>
         <span class="token comment">// Re-enable the Generate ToolTree button and stop the progress indicator</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>sender <span class="token keyword">is</span> <span class="token class-name">Button</span> BTN_GenerateToolTree<span class="token punctuation">)</span>
         <span class="token punctuation">{</span>
             ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndeterminate</span><span class="token punctuation">(</span>BTN_GenerateToolTree<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             ButtonProgressAssist<span class="token punctuation">.</span><span class="token function">SetIsIndicatorVisible</span><span class="token punctuation">(</span>BTN_GenerateToolTree<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>

         BTN_UploadToolTree<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
         BTN_Export1<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Expand TreeView" dir="auto" class="heading" id="Expand_TreeView"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Expand TreeView</h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong><code>ExpandTreeViewItems</code> Method</strong>:    
<ul>
<li data-line="1" dir="auto">Expands all nodes of a given TreeView item.</li>
<li data-line="2" dir="auto">Recursively processes all items in the <code>ItemsControl</code> to expand them.</li>
</ul>
</li>
</ul></div><div class="el-pre"><pre class="language-csharp" tabindex="0"><code data-line="0" class="language-csharp is-loaded"> <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ExpandTreeViewItems</span><span class="token punctuation">(</span><span class="token class-name">ItemsControl</span> parent<span class="token punctuation">)</span>
 <span class="token punctuation">{</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

     <span class="token comment">// Loop through all the items in the current ItemsControl</span>
     <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> item <span class="token keyword">in</span> parent<span class="token punctuation">.</span>Items<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
         <span class="token comment">// Try to get the TreeViewItem</span>
         <span class="token class-name">TreeViewItem</span> treeViewItem <span class="token operator">=</span> parent<span class="token punctuation">.</span>ItemContainerGenerator<span class="token punctuation">.</span><span class="token function">ContainerFromItem</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token class-name">TreeViewItem</span><span class="token punctuation">;</span>

         <span class="token keyword">if</span> <span class="token punctuation">(</span>treeViewItem <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
         <span class="token punctuation">{</span>
             <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>treeViewItem<span class="token punctuation">.</span>IsExpanded<span class="token punctuation">)</span>
             <span class="token punctuation">{</span>
                 <span class="token comment">// Subscribe to the event that indicates the child items have been generated</span>
                 treeViewItem<span class="token punctuation">.</span>ItemContainerGenerator<span class="token punctuation">.</span>StatusChanged <span class="token operator">+=</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                 <span class="token punctuation">{</span>
                     <span class="token keyword">if</span> <span class="token punctuation">(</span>treeViewItem<span class="token punctuation">.</span>ItemContainerGenerator<span class="token punctuation">.</span>Status <span class="token operator">==</span> GeneratorStatus<span class="token punctuation">.</span>ContainersGenerated<span class="token punctuation">)</span>
                     <span class="token punctuation">{</span>
                         <span class="token comment">// Expand child items once they are generated</span>
                         <span class="token function">ExpandTreeViewItems</span><span class="token punctuation">(</span>treeViewItem<span class="token punctuation">)</span><span class="token punctuation">;</span>
                     <span class="token punctuation">}</span>
                 <span class="token punctuation">}</span><span class="token punctuation">;</span>

                 <span class="token comment">// Expand the current TreeViewItem</span>
                 treeViewItem<span class="token punctuation">.</span>IsExpanded <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
             <span class="token keyword">else</span>
             <span class="token punctuation">{</span>
                 <span class="token comment">// If already expanded, directly expand the children recursively</span>
                 <span class="token function">ExpandTreeViewItems</span><span class="token punctuation">(</span>treeViewItem<span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
     BTN_AddSpareParts<span class="token punctuation">.</span>IsEnabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Add Spareparts" dir="auto" class="heading" id="Add_Spareparts"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Add Spareparts</h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong><code>AddSpareParts</code> Method</strong>:    
<ul>
<li data-line="1" dir="auto">Handles adding spare parts data to an external system using an API.</li>
<li data-line="2" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Steps:</strong>
<ul>
<li data-line="3" dir="auto">Iterates over <code>ZonesList</code> to find checked sub-assets.</li>
<li data-line="4" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>For each selected asset:
<ul>
<li data-line="5" dir="auto">Checks if the asset exists in an external system (Maximo) using an API.</li>
<li data-line="6" dir="auto">Retrieves existing part numbers associated with the asset from Maximo.</li>
<li data-line="7" dir="auto">Collects part numbers that do not already exist in Maximo.</li>
<li data-line="8" dir="auto">Constructs a JSON request payload and sends a POST request to add new parts.</li>
<li data-line="9" dir="auto">Informs the user about the success or failure of the process.</li>
</ul>
</li>
<li data-line="10" dir="auto">Disposes of the API client after completing all operations.</li>
</ul>
</li>
</ul>
</li>
</ul></div><div class="el-pre"><pre class="language-csharp" tabindex="0"><code data-line="0" class="language-csharp is-loaded"> <span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">AddSpareParts</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">RoutedEventArgs</span> e<span class="token punctuation">)</span>
 <span class="token punctuation">{</span>
     <span class="token comment">// Open a messagebox where the user has to enter their own api-key</span>

     <span class="token class-name"><span class="token keyword">string</span></span> baseUrl <span class="token operator">=</span> <span class="token string">"https://equi.volvocars.net"</span><span class="token punctuation">;</span>    <span class="token comment">// Base URL of your API</span>
     <span class="token class-name"><span class="token keyword">string</span></span> apiKey <span class="token operator">=</span> ConfigurationManager<span class="token punctuation">.</span>AppSettings<span class="token punctuation">[</span><span class="token string">"ApiKey"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">// Replace with your actual API key</span>
     <span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SwaggerApiClient</span><span class="token punctuation">(</span>baseUrl<span class="token punctuation">,</span> apiKey<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token keyword">try</span>
     <span class="token punctuation">{</span>
         <span class="token class-name"><span class="token keyword">bool</span></span> anyAssetsProcessed <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// To track if any assets were processed</span>

         <span class="token comment">// Iterate over ZonesList to gather selected SubAssets and send requests</span>
         <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> zone <span class="token keyword">in</span> ZonesList<span class="token punctuation">)</span>
         <span class="token punctuation">{</span>
             <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> subZone <span class="token keyword">in</span> zone<span class="token punctuation">.</span>SubZone1<span class="token punctuation">)</span>
             <span class="token punctuation">{</span>
                 <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> mainAsset <span class="token keyword">in</span> subZone<span class="token punctuation">.</span>MainAssets<span class="token punctuation">)</span>
                 <span class="token punctuation">{</span>
                     <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> subAsset <span class="token keyword">in</span> mainAsset<span class="token punctuation">.</span>SubAssets<span class="token punctuation">)</span>
                     <span class="token punctuation">{</span>
                         <span class="token keyword">if</span> <span class="token punctuation">(</span>subAsset<span class="token punctuation">.</span>IsChecked<span class="token punctuation">)</span>
                         <span class="token punctuation">{</span>
                             <span class="token comment">// Extract the AssetNumber from the selected SubAsset</span>
                             <span class="token class-name"><span class="token keyword">string</span></span> assetNumber <span class="token operator">=</span> subAsset<span class="token punctuation">.</span>AssetNumber<span class="token punctuation">?.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                             <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>assetNumber<span class="token punctuation">)</span><span class="token punctuation">)</span>
                             <span class="token punctuation">{</span>
                                 Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Warning: Asset number is missing or invalid for a checked sub-asset."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                 MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"Warning: Asset number is missing or invalid for a checked sub-asset."</span><span class="token punctuation">,</span> <span class="token string">"Asset Number Error"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Warning<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                 <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// Skip this iteration if no valid asset number is found</span>
                             <span class="token punctuation">}</span>

                             Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Processing AssetNumber: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                             <span class="token comment">// Step 1: Verify if the asset exists in Maximo</span>
                             <span class="token class-name"><span class="token keyword">string</span></span> endpointAssetCheck <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"maximo/asset/asset?assetnum=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>
                             <span class="token class-name"><span class="token keyword">bool</span></span> assetExists <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                             <span class="token keyword">try</span>
                             <span class="token punctuation">{</span>
                                 <span class="token class-name"><span class="token keyword">var</span></span> assetCheckResponse <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>List<span class="token punctuation">&lt;</span>Item<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>endpointAssetCheck<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                 assetExists <span class="token operator">=</span> assetCheckResponse <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> assetCheckResponse<span class="token punctuation">.</span><span class="token function">Any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                             <span class="token punctuation">}</span>
                             <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">HttpRequestException</span> ex<span class="token punctuation">)</span>
                             <span class="token punctuation">{</span>
                                 <span class="token keyword">if</span> <span class="token punctuation">(</span>ex<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">"NotFound"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                 <span class="token punctuation">{</span>
                                     Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Asset number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string"> does not exist in Maximo."</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                     MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Asset number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string"> does not exist in Maximo."</span></span><span class="token punctuation">,</span> <span class="token string">"Asset Not Found"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                     <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// Skip this asset if it does not exist</span>
                                 <span class="token punctuation">}</span>
                                 <span class="token keyword">else</span>
                                 <span class="token punctuation">{</span>
                                     <span class="token comment">// Log unexpected errors and continue</span>
                                     Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error checking asset number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                     MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error checking asset number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token string">"Error Checking Asset"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                     <span class="token keyword">continue</span><span class="token punctuation">;</span>
                                 <span class="token punctuation">}</span>
                             <span class="token punctuation">}</span>

                             <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>assetExists<span class="token punctuation">)</span>
                             <span class="token punctuation">{</span>
                                 Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Asset number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string"> was not found. Skipping this asset."</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                 <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// Skip processing if the asset doesn't exist</span>
                             <span class="token punctuation">}</span>

                             <span class="token comment">// Step 2: Fetch existing part numbers from Maximo</span>
                             <span class="token class-name"><span class="token keyword">string</span></span> endpoint <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"/maximo/asset/getassetspareparts?assetnum=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>

                             <span class="token class-name">List<span class="token punctuation">&lt;</span>Item<span class="token punctuation">&gt;</span></span> existingItems <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Item<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                             <span class="token keyword">try</span>
                             <span class="token punctuation">{</span>
                                 existingItems <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>List<span class="token punctuation">&lt;</span>Item<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>endpoint<span class="token punctuation">)</span><span class="token punctuation">;</span>
                             <span class="token punctuation">}</span>
                             <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">HttpRequestException</span> ex<span class="token punctuation">)</span>
                             <span class="token punctuation">{</span>
                                 <span class="token keyword">if</span> <span class="token punctuation">(</span>ex<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">"NotFound"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                 <span class="token punctuation">{</span>
                                     Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Asset number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string"> found in Maximo, but no spare parts present."</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                     MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Asset number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string"> found in Maximo, but no spare parts present."</span></span><span class="token punctuation">,</span> <span class="token string">"No Spare Parts Present"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                 <span class="token punctuation">}</span>
                                 <span class="token keyword">else</span>
                                 <span class="token punctuation">{</span>
                                     Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error fetching existing items for asset number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                     MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error fetching existing items for asset number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token string">"Error Fetching Parts"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                     <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// Skip this asset if there was an unexpected error fetching existing items</span>
                                 <span class="token punctuation">}</span>
                             <span class="token punctuation">}</span>
                             <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
                             <span class="token punctuation">{</span>
                                 Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error fetching existing items for asset number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                 MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Unexpected error fetching existing items for asset number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token string">"Unexpected Error"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                 <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// Skip this asset if there was an error fetching existing items</span>
                             <span class="token punctuation">}</span>

                             <span class="token class-name"><span class="token keyword">var</span></span> existingPartNumbers <span class="token operator">=</span> existingItems<span class="token punctuation">?.</span><span class="token function">Select</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>Itemnum<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                             <span class="token comment">// Step 3: Collect all valid part numbers for the selected SubAsset, excluding existing ones</span>
                             <span class="token class-name"><span class="token keyword">var</span></span> partNumbersSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HashSet<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Use a HashSet to store unique part numbers</span>

                             <span class="token keyword">if</span> <span class="token punctuation">(</span>subAsset<span class="token punctuation">.</span>PartNumbers <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> subAsset<span class="token punctuation">.</span>PartNumbers<span class="token punctuation">.</span><span class="token function">Any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                             <span class="token punctuation">{</span>
                                 <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> part <span class="token keyword">in</span> subAsset<span class="token punctuation">.</span>PartNumbers<span class="token punctuation">)</span>
                                 <span class="token punctuation">{</span>
                                     <span class="token comment">// Clean the part number by removing the prefix</span>
                                     <span class="token class-name"><span class="token keyword">string</span></span> partNumberCleaned <span class="token operator">=</span> part<span class="token punctuation">.</span>PartNumber<span class="token punctuation">?.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"MaximoNr: "</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                                     <span class="token comment">// Skip if part number is "Not found" or already exists in Maximo</span>
                                     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>partNumberCleaned<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
                                         <span class="token operator">!</span>partNumberCleaned<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">"Not Found"</span><span class="token punctuation">,</span> StringComparison<span class="token punctuation">.</span>OrdinalIgnoreCase<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
                                         <span class="token operator">!</span>existingPartNumbers<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>partNumberCleaned<span class="token punctuation">)</span><span class="token punctuation">)</span>
                                     <span class="token punctuation">{</span>
                                         partNumbersSet<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>partNumberCleaned<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// HashSet ensures unique part numbers</span>
                                     <span class="token punctuation">}</span>
                                     <span class="token keyword">else</span>
                                     <span class="token punctuation">{</span>
                                         Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Skipping part number '</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">part<span class="token punctuation">.</span>PartNumber</span><span class="token punctuation">}</span></span><span class="token string">' as it already exists in Maximo."</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                     <span class="token punctuation">}</span>
                                 <span class="token punctuation">}</span>
                             <span class="token punctuation">}</span>

                             <span class="token comment">// Step 4: Construct the newAssetRequest structure using the collected part numbers</span>
                             <span class="token class-name"><span class="token keyword">var</span></span> newAssetRequest <span class="token operator">=</span> <span class="token keyword">new</span>
                             <span class="token punctuation">{</span>
                                 sparepart <span class="token operator">=</span> partNumbersSet<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>partNumber <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> itemnum <span class="token operator">=</span> partNumber <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                             <span class="token punctuation">}</span><span class="token punctuation">;</span>

                             <span class="token comment">// Serialize the request payload to JSON</span>
                             <span class="token class-name"><span class="token keyword">var</span></span> jsonContent <span class="token operator">=</span> JsonConvert<span class="token punctuation">.</span><span class="token function">SerializeObject</span><span class="token punctuation">(</span>newAssetRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
                             <span class="token class-name"><span class="token keyword">var</span></span> content <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringContent</span><span class="token punctuation">(</span>jsonContent<span class="token punctuation">,</span> Encoding<span class="token punctuation">.</span>UTF8<span class="token punctuation">,</span> <span class="token string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                             <span class="token comment">// Set up the HttpClient and endpoint information for adding spare parts</span>
                             <span class="token class-name"><span class="token keyword">string</span></span> addEndpoint <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"/maximo/asset/addassetspareparts?assetnum=</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>

                             <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> httpClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HttpClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                             <span class="token punctuation">{</span>
                                 <span class="token comment">// Set the base URL and API headers</span>
                                 httpClient<span class="token punctuation">.</span>BaseAddress <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Uri</span><span class="token punctuation">(</span>baseUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                 httpClient<span class="token punctuation">.</span>DefaultRequestHeaders<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"apikey"</span><span class="token punctuation">,</span> apiKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                 httpClient<span class="token punctuation">.</span>DefaultRequestHeaders<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"Accept"</span><span class="token punctuation">,</span> <span class="token string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                                 <span class="token comment">// Inform the user that the request is being sent</span>
                                 Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Sending request to endpoint: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">addEndpoint</span><span class="token punctuation">}</span></span><span class="token string"> with payload: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">jsonContent</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                                 <span class="token comment">// Send the POST request</span>
                                 <span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> <span class="token keyword">await</span> httpClient<span class="token punctuation">.</span><span class="token function">PostAsync</span><span class="token punctuation">(</span>addEndpoint<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>

                                 <span class="token comment">// Handle the response</span>
                                 <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>IsSuccessStatusCode <span class="token operator">&amp;&amp;</span> partNumbersSet<span class="token punctuation">.</span>Count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                                 <span class="token punctuation">{</span>
                                     Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Asset spare parts added successfully for asset number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string">."</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                     MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Asset spare parts added successfully for asset number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string">."</span></span><span class="token punctuation">,</span> <span class="token string">"Success"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                 <span class="token punctuation">}</span>
                                 <span class="token keyword">else</span>
                                 <span class="token punctuation">{</span>
                                     <span class="token class-name"><span class="token keyword">var</span></span> errorResponse <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span>Content<span class="token punctuation">.</span><span class="token function">ReadAsStringAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                     Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error adding asset spare parts for asset number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string">: \nSpare Parts Already Exist"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                     MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error adding asset spare parts for asset number </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">assetNumber</span><span class="token punctuation">}</span></span><span class="token string">: \nSpare Parts Already Exist"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                 <span class="token punctuation">}</span>
                             <span class="token punctuation">}</span>

                             anyAssetsProcessed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// Mark that at least one asset has been processed</span>
                         <span class="token punctuation">}</span>
                     <span class="token punctuation">}</span>
                 <span class="token punctuation">}</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>

         <span class="token comment">// If no assets were processed at all, inform the user</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>anyAssetsProcessed<span class="token punctuation">)</span>
         <span class="token punctuation">{</span>
             Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"No assets were processed and added to Maximo."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"No assets were processed and added to Maximo."</span><span class="token punctuation">,</span> <span class="token string">"No Assets Processed"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Warning<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">HttpRequestException</span> ex<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
         <span class="token comment">// Display specific error messages in the UI     </span>
         Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"HTTP Request error: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"HTTP Request error: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token string">"HTTP Error"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
         <span class="token comment">// Handle unexpected errors    </span>
         Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Unexpected error: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Unexpected error: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token string">"Unexpected Error"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">finally</span>
     <span class="token punctuation">{</span>
         client<span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Ensure HttpClient is disposed of properly</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Export TreeView" dir="auto" class="heading" id="Export_TreeView"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Export TreeView</h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong><code>Button_Export_Tree</code> Method</strong>:    
<ul>
<li data-line="1" dir="auto">Handles exporting the tree view data (<code>treeViewToTable</code>) to an Excel file.</li>
<li data-line="2" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Steps:</strong>
<ul>
<li data-line="3" dir="auto">Checks if the data (<code>treeViewToTable</code>) exists.</li>
<li data-line="4" dir="auto">If the data exists, uses a <code>ToolTreeExporter</code> to export it to Excel.</li>
<li data-line="5" dir="auto">Provides an interface for the user to save the exported file.</li>
</ul>
</li>
</ul>
</li>
</ul></div><div class="el-pre"><pre class="language-csharp" tabindex="0"><code data-line="0" class="language-csharp is-loaded">   <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Button_Export_Tree</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">RoutedEventArgs</span> e<span class="token punctuation">)</span>
       <span class="token punctuation">{</span>
       

       <span class="token keyword">if</span> <span class="token punctuation">(</span>treeViewToTable <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
       <span class="token punctuation">{</span>
           MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"Tool tree data is not available."</span><span class="token punctuation">,</span> <span class="token string">"Error"</span><span class="token punctuation">,</span> MessageBoxButton<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxImage<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">return</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>

       <span class="token comment">// Instantiate ToolTreeExporter with the DataTable</span>
       <span class="token class-name">ToolTreeExporter</span> exporter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ToolTreeExporter</span><span class="token punctuation">(</span>treeViewToTable<span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token comment">// Call the method to export the tree</span>
       exporter<span class="token punctuation">.</span><span class="token function">ExportDataTableToExcelWithDialogAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="mod-footer mod-ui"></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#ONLOADED"><div class="tree-item-contents heading-link" heading-name="ONLOADED"><span class="tree-item-title">ONLOADED</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#MDL_COMPARATOR"><div class="tree-item-contents heading-link" heading-name="MDL COMPARATOR"><span class="tree-item-title">MDL COMPARATOR</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#Button_Browse"><div class="tree-item-contents heading-link" heading-name="Button Browse"><span class="tree-item-title">Button Browse</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#Button_Process"><div class="tree-item-contents heading-link" heading-name="Button Process"><span class="tree-item-title">Button Process</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#Keydown"><div class="tree-item-contents heading-link" heading-name="Keydown"><span class="tree-item-title">Keydown</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#Perform_Search"><div class="tree-item-contents heading-link" heading-name="Perform Search"><span class="tree-item-title">Perform Search</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#Button_Reset_Fields"><div class="tree-item-contents heading-link" heading-name="Button Reset Fields"><span class="tree-item-title">Button Reset Fields</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#Button_Export"><div class="tree-item-contents heading-link" heading-name="Button Export"><span class="tree-item-title">Button Export</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#TOOLTREE__GENERATOR"><div class="tree-item-contents heading-link" heading-name="TOOLTREE  GENERATOR"><span class="tree-item-title">TOOLTREE  GENERATOR</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#Item_class"><div class="tree-item-contents heading-link" heading-name="Item class"><span class="tree-item-title">Item class</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#OnPropertyChanged"><div class="tree-item-contents heading-link" heading-name="OnPropertyChanged"><span class="tree-item-title">OnPropertyChanged</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#Upload_ToolTree"><div class="tree-item-contents heading-link" heading-name="Upload ToolTree"><span class="tree-item-title">Upload ToolTree</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#Generate_ToolTree"><div class="tree-item-contents heading-link" heading-name="Generate ToolTree"><span class="tree-item-title">Generate ToolTree</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#Expand_TreeView"><div class="tree-item-contents heading-link" heading-name="Expand TreeView"><span class="tree-item-title">Expand TreeView</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#Add_Spareparts"><div class="tree-item-contents heading-link" heading-name="Add Spareparts"><span class="tree-item-title">Add Spareparts</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\csharp\rm-tool\mainwindow.xaml.cs.html#Export_TreeView"><div class="tree-item-contents heading-link" heading-name="Export TreeView"><span class="tree-item-title">Export TreeView</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>