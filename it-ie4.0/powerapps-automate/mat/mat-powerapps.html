<!DOCTYPE html> <html><head>
		<title>MAT PowerApps</title>
		<base href="..\..\..\../">
		<meta id="root-path" root-path="..\..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Mindmap Obsidian - MAT PowerApps">
		<meta property="og:title" content="MAT PowerApps">
		<meta property="og:description" content="Mindmap Obsidian - MAT PowerApps">
		<meta property="og:type" content="website">
		<meta property="og:url" content="volvo/it-ie4.0/powerapps-automate/mat/mat-powerapps.html">
		<meta property="og:image" content="undefined">
		<meta property="og:site_name" content="Mindmap Obsidian">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/supported-plugins.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="MAT PowerApps">MAT PowerApps</h1><div class="el-h2 heading-wrapper"><h2 data-heading="Onloaded Screen" dir="auto" class="heading" id="Onloaded_Screen"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Onloaded Screen</h2><div class="heading-children"><div class="el-p"><p dir="auto"><a href="?query=tag:Onstart" class="tag" target="_blank" rel="noopener nofollow">#Onstart</a> </p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>Initialization:</strong> The code begins by setting a variable <code>varEmail</code> to store the current user's email, which is retrieved using <code>User().Email</code>. This variable can also be set manually for testing purposes by uncommenting the test line with a specific email address.<br>
</li>
<li data-line="2" dir="auto"><strong>Running a Flow:</strong> The <code>DepartmentSelect.Run(varEmail)</code> flow is executed using the user's email, and its results are stored in the <code>DepartmentLibrary</code> variable. This flow likely retrieves department-specific data or permissions based on the user's email.<br>
</li>
<li data-line="4" dir="auto"><strong>Access Check:</strong> The <code>If</code> statement checks if the department libraries (<code>libga</code>, <code>libgb</code>, <code>libgc</code>) within <code>DepartmentLibrary</code> are all empty (<code>IsBlank</code>). If they are, it triggers a notification to inform the user that they do not have access and advises them to contact the administrator, using an error notification type. This likely controls the navigation flow based on whether the user has the necessary access permissions.</li>
</ul></div><div class="el-pre"><pre class="language-javascript" tabindex="0"><code data-line="0" class="language-javascript is-loaded"><span class="token comment">// Initialize user email and navigation control variable</span>
<span class="token known-class-name class-name">Set</span><span class="token punctuation">(</span>
    varEmail<span class="token punctuation">,</span> <span class="token comment">// Variable to store the user's email</span>
    <span class="token function"><span class="token maybe-class-name">User</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Email</span></span> <span class="token comment">// Retrieves the current user's email address</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// For testing, you can use a specific email</span>
<span class="token comment">// Set(varEmail, "stijn@gmail.com"); // Uncomment this line for testing with a specific email</span>

<span class="token comment">// Run the flow to get data based on the user's email</span>
<span class="token known-class-name class-name">Set</span><span class="token punctuation">(</span>
    <span class="token maybe-class-name">DepartmentLibrary</span><span class="token punctuation">,</span> <span class="token comment">// Variable to store the result of the flow</span>
    <span class="token maybe-class-name">DepartmentSelect</span><span class="token punctuation">.</span><span class="token method function property-access"><span class="token maybe-class-name">Run</span></span><span class="token punctuation">(</span>varEmail<span class="token punctuation">)</span> <span class="token comment">// Calls the flow 'DepartmentSelect' with the user's email as input</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Determine the start screen based on the flow result</span>
<span class="token function"><span class="token maybe-class-name">If</span></span><span class="token punctuation">(</span>
    <span class="token function"><span class="token maybe-class-name">IsBlank</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">DepartmentLibrary</span><span class="token punctuation">.</span><span class="token property-access">libga</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function"><span class="token maybe-class-name">IsBlank</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">DepartmentLibrary</span><span class="token punctuation">.</span><span class="token property-access">libgb</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function"><span class="token maybe-class-name">IsBlank</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">DepartmentLibrary</span><span class="token punctuation">.</span><span class="token property-access">libgc</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Checks if all specific department libraries are empty</span>
    <span class="token function"><span class="token maybe-class-name">Notify</span></span><span class="token punctuation">(</span>
        <span class="token string">"You don't have access, contact Administrator"</span><span class="token punctuation">,</span> <span class="token comment">// Message displayed to the user if they don't have access</span>
        <span class="token maybe-class-name">NotificationType</span><span class="token punctuation">.</span><span class="token known-class-name class-name">Error</span> <span class="token comment">// Sets the notification type to Error</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="StartScreen GA/GB/GC button" dir="auto" class="heading" id="StartScreen_GA/GB/GC_button"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>StartScreen GA/GB/GC button</h2><div class="heading-children"><div class="el-p"><p dir="auto"><a href="?query=tag:OnSelect" class="tag" target="_blank" rel="noopener nofollow">#OnSelect</a></p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>Navigation:</strong> The <code>Navigate(LibraryScreenGC)</code> function is used to change the screen in the app to <code>LibraryScreenGC</code>. This function handles moving the user to the specified screen.<br>
</li>
<li data-line="2" dir="auto"><strong>Setting a Variable:</strong> The <code>Set(GC_Enabled, true)</code> function sets the variable <code>GC_Enabled</code> to <code>true</code>. This variable likely controls some functionality or visibility related to the <code>GC</code> feature or section within the app, enabling it after the screen navigation.</li>
</ul></div><div class="el-pre"><pre class="language-javascript" tabindex="0"><code data-line="0" class="language-javascript is-loaded"><span class="token comment">// Navigate to the LibraryScreenGC screen</span>
<span class="token function"><span class="token maybe-class-name">Navigate</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">LibraryScreenGC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Set the GC_Enabled variable to true</span>
<span class="token known-class-name class-name">Set</span><span class="token punctuation">(</span><span class="token maybe-class-name">GC_Enabled</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><a href="?query=tag:DisplayMode" class="tag" target="_blank" rel="noopener nofollow">#DisplayMode</a></p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Condition Check:</strong> The <code>If</code> function evaluates two conditions:    
<ul>
<li data-line="1" dir="auto"><code>!IsError(DepartmentLibrary.libgc)</code>: Checks if there is no error associated with <code>DepartmentLibrary.libgc</code>.</li>
<li data-line="2" dir="auto"><code>Find("GC", DepartmentLibrary.libgc) &gt; 0</code>: Checks if the substring "GC" exists within <code>DepartmentLibrary.libgc</code>. The <code>Find</code> function returns the position of the substring, and if it's greater than 0, it confirms that "GC" is present.</li>
</ul>
</li>
<li data-line="4" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Setting Button State:</strong>    
<ul>
<li data-line="5" dir="auto">If both conditions are true, the button (or control) is set to <code>DisplayMode.Edit</code>, making it interactive or clickable.</li>
<li data-line="6" dir="auto">If either condition is false, the button is set to <code>DisplayMode.Disabled</code>, making it non-interactive or not clickable.</li>
</ul>
</li>
</ul></div><div class="el-pre"><pre class="language-javascript" tabindex="0"><code data-line="0" class="language-javascript is-loaded"><span class="token function"><span class="token maybe-class-name">If</span></span><span class="token punctuation">(</span>
    <span class="token comment">// Check if there is no error in DepartmentLibrary.libgc and if "GC" is found within libgc</span>
    <span class="token operator">!</span><span class="token known-class-name class-name">IsError</span><span class="token punctuation">(</span><span class="token maybe-class-name">DepartmentLibrary</span><span class="token punctuation">.</span><span class="token property-access">libgc</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function"><span class="token maybe-class-name">Find</span></span><span class="token punctuation">(</span><span class="token string">"GC"</span><span class="token punctuation">,</span> <span class="token maybe-class-name">DepartmentLibrary</span><span class="token punctuation">.</span><span class="token property-access">libgc</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span>
    
    <span class="token maybe-class-name">DisplayMode</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Edit</span></span><span class="token punctuation">,</span> <span class="token comment">// If both conditions are true, set the button to be clickable (editable)</span>
    
    <span class="token maybe-class-name">DisplayMode</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Disabled</span></span> <span class="token comment">// If either condition is false, set the button to be not clickable (disabled)</span>
<span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="LibraryScreenGA/GB/GC button" dir="auto" class="heading" id="LibraryScreenGA/GB/GC_button"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>LibraryScreenGA/GB/GC button</h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Setting Variables:</strong>    
<ul>
<li data-line="1" dir="auto"><code>Set(LibraryID, "Documentatie Pre Trim")</code>: This line sets the variable <code>LibraryID</code> to the value <code>"Documentatie Pre Trim"</code>, which likely represents the name or identifier of a specific documentation library.</li>
<li data-line="2" dir="auto"><code>Set(varDepar, "https://intranet.volvocars.net/sites/DocumentationLibraryPretrim")</code>: This line sets the variable <code>varDepar</code> to a specific URL, pointing to the "Documentation Library Pretrim" site on the intranet. This URL is probably used for accessing resources related to the selected library.</li>
</ul>
</li>
<li data-line="4" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Navigation:</strong>    
<ul>
<li data-line="5" dir="auto"><code>Navigate(ScanScreen, ScreenTransition.Fade)</code>: This line navigates the user to the <code>ScanScreen</code> using a fade transition effect, creating a smooth screen transition. This likely directs the user to a scanning or data entry screen within the app.</li>
</ul>
</li>
</ul></div><div class="el-pre"><pre class="language-javascript" tabindex="0"><code data-line="0" class="language-javascript is-loaded"><span class="token comment">// Set the LibraryID variable to a specific library name</span>
<span class="token known-class-name class-name">Set</span><span class="token punctuation">(</span><span class="token maybe-class-name">LibraryID</span><span class="token punctuation">,</span> <span class="token string">"Documentatie Pre Trim"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Set the varDepar variable to a specific URL</span>
<span class="token known-class-name class-name">Set</span><span class="token punctuation">(</span>varDepar<span class="token punctuation">,</span> <span class="token string">"https://intranet.volvocars.net/sites/DocumentationLibraryPretrim"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Navigate to the ScanScreen with a fade transition effect</span>
<span class="token function"><span class="token maybe-class-name">Navigate</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">ScanScreen</span><span class="token punctuation">,</span> <span class="token maybe-class-name">ScreenTransition</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Fade</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="ScanScreen Barcode Scanner/Manual button" dir="auto" class="heading" id="ScanScreen_Barcode_Scanner/Manual_button"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>ScanScreen Barcode Scanner/Manual button</h2><div class="heading-children"><div class="el-p"><p dir="auto"> <a href="?query=tag:OnSelect" class="tag" target="_blank" rel="noopener nofollow">#OnSelect</a> <a href="?query=tag:OnScan" class="tag" target="_blank" rel="noopener nofollow">#OnScan</a></p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>Setting Variables:</strong> The code sets variables <code>varText</code> and <code>varEmail</code> with user input and the user's email, respectively, to prepare for running flows.<br>
</li>
<li data-line="2" dir="auto"><strong>Showing Loading Bar:</strong> It updates the context variable <code>varLoading</code> to <code>true</code> to display a loading bar while processes run in the background.<br>
</li>
<li data-line="4" dir="auto"><strong>Running Flows Concurrently:</strong> The <code>Concurrent</code> function is used to run multiple flows simultaneously, each fetching different types of links (<code>MTTR</code>, <code>PI</code>, <code>CI</code>, <code>Eplan</code>, and <code>MainFolder</code>) based on the input variables (<code>varText</code>, <code>LibraryID</code>, <code>varDepar</code>). This improves the app's performance by reducing wait times.<br>
</li>
<li data-line="6" dir="auto"><strong>Parsing JSON Responses:</strong> The <code>Set(ParsedLinks, {...})</code> block processes the JSON results from each flow, extracting the relevant links if they are not empty or just placeholders (i.e., <code>"[]"</code>). This ensures the app handles the actual data and discards any empty or irrelevant results.<br>
</li>
<li data-line="8" dir="auto"><strong>Hiding Loading Bar:</strong> After the flows complete, the loading bar is hidden by setting <code>varLoading</code> to <code>false</code>.<br>
</li>
<li data-line="10" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Final Check and Navigation/Notification:</strong> The final <code>If</code> statement checks if all parsed links are empty:    
<ul>
<li data-line="11" dir="auto">If all links are empty, it shows an error notification, "Asset not found in database."</li>
<li data-line="12" dir="auto">If any link is present, it navigates the user to the <code>Linkscreen</code>, guiding them to the appropriate screen based on available data.</li>
</ul>
</li>
</ul></div><div class="el-pre"><pre class="language-javascript" tabindex="0"><code data-line="0" class="language-javascript is-loaded"><span class="token comment">// Set variables for the next page and user email</span>
<span class="token known-class-name class-name">Set</span><span class="token punctuation">(</span>varText<span class="token punctuation">,</span> <span class="token maybe-class-name">InputField</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Text</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Stores the text input from the user in varText</span>
<span class="token known-class-name class-name">Set</span><span class="token punctuation">(</span>varEmail<span class="token punctuation">,</span> <span class="token function"><span class="token maybe-class-name">User</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Email</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Stores the current user's email in varEmail</span>

<span class="token comment">// Show loading bar by setting the varLoading context variable to true</span>
<span class="token function"><span class="token maybe-class-name">UpdateContext</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">varLoading</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Run multiple flows concurrently to improve performance</span>
<span class="token function"><span class="token maybe-class-name">Concurrent</span></span><span class="token punctuation">(</span>
    <span class="token known-class-name class-name">Set</span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputMTTR</span><span class="token punctuation">,</span> <span class="token maybe-class-name">GetLinkMTTR</span><span class="token punctuation">.</span><span class="token method function property-access"><span class="token maybe-class-name">Run</span></span><span class="token punctuation">(</span>varText<span class="token punctuation">,</span> <span class="token maybe-class-name">LibraryID</span><span class="token punctuation">,</span> varDepar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Calls GetLinkMTTR flow with inputs and stores the result in OutputMTTR</span>
    <span class="token known-class-name class-name">Set</span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputPI</span><span class="token punctuation">,</span> <span class="token maybe-class-name">GetLinkPI</span><span class="token punctuation">.</span><span class="token method function property-access"><span class="token maybe-class-name">Run</span></span><span class="token punctuation">(</span>varText<span class="token punctuation">,</span> <span class="token maybe-class-name">LibraryID</span><span class="token punctuation">,</span> varDepar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Calls GetLinkPI flow and stores the result in OutputPI</span>
    <span class="token known-class-name class-name">Set</span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputCI</span><span class="token punctuation">,</span> <span class="token maybe-class-name">GetLinkCI</span><span class="token punctuation">.</span><span class="token method function property-access"><span class="token maybe-class-name">Run</span></span><span class="token punctuation">(</span>varText<span class="token punctuation">,</span> <span class="token maybe-class-name">LibraryID</span><span class="token punctuation">,</span> varDepar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Calls GetLinkCI flow and stores the result in OutputCI</span>
    <span class="token known-class-name class-name">Set</span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputEplan</span><span class="token punctuation">,</span> <span class="token maybe-class-name">GetLinkEplan</span><span class="token punctuation">.</span><span class="token method function property-access"><span class="token maybe-class-name">Run</span></span><span class="token punctuation">(</span>varText<span class="token punctuation">,</span> <span class="token maybe-class-name">LibraryID</span><span class="token punctuation">,</span> varDepar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Calls GetLinkEplan flow and stores the result in OutputEplan</span>
    <span class="token known-class-name class-name">Set</span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputMainFolder</span><span class="token punctuation">,</span> <span class="token maybe-class-name">GetLinkMainFolder</span><span class="token punctuation">.</span><span class="token method function property-access"><span class="token maybe-class-name">Run</span></span><span class="token punctuation">(</span>varText<span class="token punctuation">,</span> <span class="token maybe-class-name">LibraryID</span><span class="token punctuation">,</span> varDepar<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Calls GetLinkMainFolder flow and stores the result in OutputMainFolder</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Consolidate and process JSON responses from the flows using a helper function</span>
<span class="token known-class-name class-name">Set</span><span class="token punctuation">(</span><span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token literal-property property">LinkMTTR</span><span class="token operator">:</span> <span class="token function"><span class="token maybe-class-name">If</span></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function"><span class="token maybe-class-name">IsBlank</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputMTTR</span><span class="token punctuation">.</span><span class="token property-access">linkmttr</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token maybe-class-name">OutputMTTR</span><span class="token punctuation">.</span><span class="token property-access">linkmttr</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">"[]"</span><span class="token punctuation">,</span> <span class="token function"><span class="token maybe-class-name">Mid</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputMTTR</span><span class="token punctuation">.</span><span class="token property-access">linkmttr</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token function"><span class="token maybe-class-name">Len</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputMTTR</span><span class="token punctuation">.</span><span class="token property-access">linkmttr</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Parses OutputMTTR to get the actual link if not empty</span>
        <span class="token literal-property property">LinkPI</span><span class="token operator">:</span> <span class="token function"><span class="token maybe-class-name">If</span></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function"><span class="token maybe-class-name">IsBlank</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputPI</span><span class="token punctuation">.</span><span class="token property-access">linkpi</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token maybe-class-name">OutputPI</span><span class="token punctuation">.</span><span class="token property-access">linkpi</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">"[]"</span><span class="token punctuation">,</span> <span class="token function"><span class="token maybe-class-name">Mid</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputPI</span><span class="token punctuation">.</span><span class="token property-access">linkpi</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token function"><span class="token maybe-class-name">Len</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputPI</span><span class="token punctuation">.</span><span class="token property-access">linkpi</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Parses OutputPI to get the actual link if not empty</span>
        <span class="token literal-property property">LinkCI</span><span class="token operator">:</span> <span class="token function"><span class="token maybe-class-name">If</span></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function"><span class="token maybe-class-name">IsBlank</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputCI</span><span class="token punctuation">.</span><span class="token property-access">linkci</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token maybe-class-name">OutputCI</span><span class="token punctuation">.</span><span class="token property-access">linkci</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">"[]"</span><span class="token punctuation">,</span> <span class="token function"><span class="token maybe-class-name">Mid</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputCI</span><span class="token punctuation">.</span><span class="token property-access">linkci</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token function"><span class="token maybe-class-name">Len</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputCI</span><span class="token punctuation">.</span><span class="token property-access">linkci</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Parses OutputCI to get the actual link if not empty</span>
        <span class="token literal-property property">LinkEplan</span><span class="token operator">:</span> <span class="token function"><span class="token maybe-class-name">If</span></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function"><span class="token maybe-class-name">IsBlank</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputEplan</span><span class="token punctuation">.</span><span class="token property-access">linkeplan</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token maybe-class-name">OutputEplan</span><span class="token punctuation">.</span><span class="token property-access">linkeplan</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">"[]"</span><span class="token punctuation">,</span> <span class="token function"><span class="token maybe-class-name">Mid</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputEplan</span><span class="token punctuation">.</span><span class="token property-access">linkeplan</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token function"><span class="token maybe-class-name">Len</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputEplan</span><span class="token punctuation">.</span><span class="token property-access">linkeplan</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Parses OutputEplan to get the actual link if not empty</span>
        <span class="token literal-property property">LinkMainFolder</span><span class="token operator">:</span> <span class="token function"><span class="token maybe-class-name">If</span></span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function"><span class="token maybe-class-name">IsBlank</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputMainFolder</span><span class="token punctuation">.</span><span class="token property-access">linkmainfolder</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token maybe-class-name">OutputMainFolder</span><span class="token punctuation">.</span><span class="token property-access">linkmainfolder</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">"[]"</span><span class="token punctuation">,</span> <span class="token function"><span class="token maybe-class-name">Mid</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputMainFolder</span><span class="token punctuation">.</span><span class="token property-access">linkmainfolder</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token function"><span class="token maybe-class-name">Len</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">OutputMainFolder</span><span class="token punctuation">.</span><span class="token property-access">linkmainfolder</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment">// Parses OutputMainFolder to get the actual link if not empty</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Hide the loading bar by setting the varLoading context variable to false</span>
<span class="token function"><span class="token maybe-class-name">UpdateContext</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">varLoading</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Check if all parsed links are empty; if so, notify the user of a missing asset, otherwise navigate to the Linkscreen</span>
<span class="token function"><span class="token maybe-class-name">If</span></span><span class="token punctuation">(</span>
    <span class="token function"><span class="token maybe-class-name">IsBlank</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkMTTR</span></span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function"><span class="token maybe-class-name">IsBlank</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkPI</span></span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function"><span class="token maybe-class-name">IsBlank</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkCI</span></span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function"><span class="token maybe-class-name">IsBlank</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkEplan</span></span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function"><span class="token maybe-class-name">IsBlank</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkMainFolder</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function"><span class="token maybe-class-name">Notify</span></span><span class="token punctuation">(</span><span class="token string">"Asset not found in database."</span><span class="token punctuation">,</span> <span class="token maybe-class-name">NotificationType</span><span class="token punctuation">.</span><span class="token known-class-name class-name">Error</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Shows an error notification if no links are found</span>
    <span class="token function"><span class="token maybe-class-name">Navigate</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">Linkscreen</span><span class="token punctuation">)</span> <span class="token comment">// Navigates to the Linkscreen if any link is available</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div><div class="el-h3 heading-wrapper"><h3 data-heading="LinkScreen Tile Explanation" dir="auto" class="heading" id="LinkScreen_Tile_Explanation"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>LinkScreen Tile Explanation</h3><div class="heading-children"><div class="el-p"><p dir="auto"><a href="?query=tag:OnSelect" class="tag" target="_blank" rel="noopener nofollow">#OnSelect</a> </p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Condition Check:</strong>    
<ul>
<li data-line="1" dir="auto"><code>!IsBlank(ParsedLinks.LinkMainFolder)</code>: This checks if the <code>LinkMainFolder</code> from <code>ParsedLinks</code> is not empty.</li>
<li data-line="2" dir="auto"><code>(Left(ParsedLinks.LinkMainFolder, 7) = "http://" || Left(ParsedLinks.LinkMainFolder, 8) = "https://")</code>: This checks if the link starts with either "http://" (7 characters) or "https://" (8 characters). This ensures that the link is a valid web URL.</li>
</ul>
</li>
<li data-line="4" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Action Based on Condition:</strong>    
<ul>
<li data-line="5" dir="auto"><strong>If the conditions are true:</strong> The <code>Launch(ParsedLinks.LinkMainFolder)</code> function is executed, which opens the URL in the default web browser.</li>
<li data-line="6" dir="auto"><strong>If the conditions are false:</strong> The <code>Notify("No valid link to open", NotificationType.Error)</code> function displays an error notification, informing the user that there is no valid link to open.</li>
</ul>
</li>
</ul></div><div class="el-pre"><pre class="language-javascript" tabindex="0"><code data-line="0" class="language-javascript is-loaded"><span class="token comment">// Checks if the variable ParsedLinks.LinkMainFolder starts with "http://" or "https://" </span>
<span class="token comment">// and if it is not blank; otherwise, it shows a pop-up notification indicating there is no valid link to open</span>
<span class="token function"><span class="token maybe-class-name">If</span></span><span class="token punctuation">(</span> 
    <span class="token operator">!</span><span class="token function"><span class="token maybe-class-name">IsBlank</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkMainFolder</span></span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token comment">// Checks if ParsedLinks.LinkMainFolder is not blank</span>
    <span class="token punctuation">(</span><span class="token function"><span class="token maybe-class-name">Left</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkMainFolder</span></span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"http://"</span> <span class="token operator">||</span> <span class="token function"><span class="token maybe-class-name">Left</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkMainFolder</span></span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"https://"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Checks if the link starts with "http://" or "https://"</span>
    
    <span class="token function"><span class="token maybe-class-name">Launch</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkMainFolder</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// If the conditions are met, launches the link in a web browser</span>
    
    <span class="token function"><span class="token maybe-class-name">Notify</span></span><span class="token punctuation">(</span><span class="token string">"No valid link to open"</span><span class="token punctuation">,</span> <span class="token maybe-class-name">NotificationType</span><span class="token punctuation">.</span><span class="token known-class-name class-name">Error</span><span class="token punctuation">)</span> <span class="token comment">// If conditions are not met, shows an error notification</span>
<span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><a href="?query=tag:ToolTip" class="tag" target="_blank" rel="noopener nofollow">#ToolTip</a></p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Condition Check:</strong>    
<ul>
<li data-line="1" dir="auto"><code>!IsBlank(ParsedLinks.LinkMainFolder)</code>: Checks if <code>ParsedLinks.LinkMainFolder</code> is not blank, meaning there is a link available.</li>
<li data-line="2" dir="auto"><code>(Left(ParsedLinks.LinkMainFolder, 7) = "http://" || Left(ParsedLinks.LinkMainFolder, 8) = "https://")</code>: Checks if the link starts with either "http://" or "https://", ensuring it is a valid web URL.</li>
</ul>
</li>
<li data-line="4" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Result Based on Condition:</strong>    
<ul>
<li data-line="5" dir="auto"><strong>If the conditions are true:</strong> The expression returns <code>"Click to open the link"</code>, indicating that there is a valid link available to be opened.</li>
<li data-line="6" dir="auto"><strong>If the conditions are false:</strong> The expression returns <code>"No valid link to open"</code>, indicating that the link is either missing or not formatted correctly as a web URL.</li>
</ul>
</li>
</ul></div><div class="el-pre"><pre class="language-javascript" tabindex="0"><code data-line="0" class="language-javascript is-loaded"><span class="token function"><span class="token maybe-class-name">If</span></span><span class="token punctuation">(</span>
    <span class="token comment">// Checks if ParsedLinks.LinkMainFolder is not blank and starts with "http://" or "https://"</span>
    <span class="token operator">!</span><span class="token function"><span class="token maybe-class-name">IsBlank</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkMainFolder</span></span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> 
    <span class="token punctuation">(</span><span class="token function"><span class="token maybe-class-name">Left</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkMainFolder</span></span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"http://"</span> <span class="token operator">||</span> <span class="token function"><span class="token maybe-class-name">Left</span></span><span class="token punctuation">(</span><span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkMainFolder</span></span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"https://"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    
    <span class="token string">"Click to open the link"</span><span class="token punctuation">,</span> <span class="token comment">// If the conditions are met, the output is "Click to open the link"</span>
    
    <span class="token string">"No valid link to open"</span> <span class="token comment">// If the conditions are not met, the output is "No valid link to open"</span>
<span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="LinkScreen Teams Tile" dir="auto" class="heading" id="LinkScreen_Teams_Tile"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>LinkScreen Teams Tile</h3><div class="heading-children"><div class="el-p"><p dir="auto"><a href="?query=tag:OnSelect" class="tag" target="_blank" rel="noopener nofollow">#OnSelect</a> </p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>Running the Flow:</strong> The <code>SendLinksToTeams.Run</code> function is called to execute the flow named <code>SendLinksToTeams</code>. This flow is designed to send a set of links along with user and context information to a Microsoft Teams channel or chat.<br>
</li>
<li data-line="2" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Passing Parameters to the Flow:</strong>    
<ul>
<li data-line="3" dir="auto"><strong>Links:</strong> The flow is passed five links (<code>LinkMTTR</code>, <code>LinkPI</code>, <code>LinkCI</code>, <code>LinkMainFolder</code>, and <code>LinkEplan</code>) extracted from the <code>ParsedLinks</code> object. These links represent different resources that need to be sent.</li>
<li data-line="4" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>User and Context Information:</strong>
<ul>
<li data-line="5" dir="auto"><code>varEmail</code>: The user's email, which might be used for identification or to personalize the message.</li>
<li data-line="6" dir="auto"><code>varText</code>: The text input from the user, which might provide additional context or details for the message.</li>
<li data-line="7" dir="auto"><code>LibraryID</code>: The identifier of the library in context, possibly used to specify which documentation or resources the links pertain to.</li>
</ul>
</li>
</ul>
</li>
<li data-line="9" dir="auto"><strong>Storing the Output:</strong> The result of the flow execution is stored in the variable <code>OutputLinks</code>, which can be used later in the app to check the status or outcome of the flow, such as confirming that the links were successfully sent to Teams.</li>
</ul></div><div class="el-pre"><pre class="language-javascript" tabindex="0"><code data-line="0" class="language-javascript is-loaded"><span class="token comment">// Run the flow to send links to Teams</span>
<span class="token known-class-name class-name">Set</span><span class="token punctuation">(</span>
    <span class="token maybe-class-name">OutputLinks</span><span class="token punctuation">,</span> <span class="token comment">// Variable to store the result of the flow</span>
    <span class="token maybe-class-name">SendLinksToTeams</span><span class="token punctuation">.</span><span class="token method function property-access"><span class="token maybe-class-name">Run</span></span><span class="token punctuation">(</span>
        <span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkMTTR</span></span><span class="token punctuation">,</span> <span class="token comment">// Sends the MTTR link from ParsedLinks</span>
        <span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkPI</span></span><span class="token punctuation">,</span> <span class="token comment">// Sends the PI link from ParsedLinks</span>
        <span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkCI</span></span><span class="token punctuation">,</span> <span class="token comment">// Sends the CI link from ParsedLinks</span>
        <span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkMainFolder</span></span><span class="token punctuation">,</span> <span class="token comment">// Sends the Main Folder link from ParsedLinks</span>
        <span class="token maybe-class-name">ParsedLinks</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">LinkEplan</span></span><span class="token punctuation">,</span> <span class="token comment">// Sends the Eplan link from ParsedLinks</span>
        varEmail<span class="token punctuation">,</span> <span class="token comment">// Includes the user's email</span>
        varText<span class="token punctuation">,</span> <span class="token comment">// Includes the text input from the user</span>
        <span class="token maybe-class-name">LibraryID</span> <span class="token comment">// Includes the Library ID</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="mod-footer mod-ui"></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="volvo\it-ie4.0\powerapps-automate\mat\mat-powerapps.html#MAT PowerApps"><div class="tree-item-contents heading-link" heading-name="MAT PowerApps"><span class="tree-item-title">MAT PowerApps</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\powerapps-automate\mat\mat-powerapps.html#Onloaded_Screen"><div class="tree-item-contents heading-link" heading-name="Onloaded Screen"><span class="tree-item-title">Onloaded Screen</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\powerapps-automate\mat\mat-powerapps.html#StartScreen_GA/GB/GC_button"><div class="tree-item-contents heading-link" heading-name="StartScreen GA/GB/GC button"><span class="tree-item-title">StartScreen GA/GB/GC button</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\powerapps-automate\mat\mat-powerapps.html#LibraryScreenGA/GB/GC_button"><div class="tree-item-contents heading-link" heading-name="LibraryScreenGA/GB/GC button"><span class="tree-item-title">LibraryScreenGA/GB/GC button</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="volvo\it-ie4.0\powerapps-automate\mat\mat-powerapps.html#ScanScreen_Barcode_Scanner/Manual_button"><div class="tree-item-contents heading-link" heading-name="ScanScreen Barcode Scanner/Manual button"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">ScanScreen Barcode Scanner/Manual button</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="volvo\it-ie4.0\powerapps-automate\mat\mat-powerapps.html#LinkScreen_Tile_Explanation"><div class="tree-item-contents heading-link" heading-name="LinkScreen Tile Explanation"><span class="tree-item-title">LinkScreen Tile Explanation</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="volvo\it-ie4.0\powerapps-automate\mat\mat-powerapps.html#LinkScreen_Teams_Tile"><div class="tree-item-contents heading-link" heading-name="LinkScreen Teams Tile"><span class="tree-item-title">LinkScreen Teams Tile</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>